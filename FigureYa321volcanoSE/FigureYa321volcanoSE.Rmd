---
title: "FigureYa321volcanoSE"
params:
  author: "Xiaofan Lu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

在癌症中高低分数组中的APA分析，用火山图展示 (图5B)。

Differential APA analysis between high- and low-risk groups in cancer, presented via volcano plot (Fig.5 B).

![](example.png)

出自：<https://www.frontiersin.org/articles/10.3389/fimmu.2022.1031184/full>

图5 与WM_Score相关的转录和转录后特征。
(B) WM_Score_high组和WM_Score_low组各基因的**PDUI差异**。

Source: <https://www.frontiersin.org/articles/10.3389/fimmu.2022.1031184/full>

FIGURE 5 Transcriptional and post-transcriptional characteristics related to WM_Score.
(B) **The differences in the PDUI** of each gene between WM_Score_high and WM_Score_low groups.

# 应用场景
# Application scenarios

例文关注的是PAAD，可以套用于TCGA其他癌症类型。

使用火山图展示差异分析结果。也可以使用FigureYa其他作者绘制的更复杂的火山图：

- 一组：FigureYa59volcano <https://k.youshop10.com/spa8oEli>，FigureYa75baseVolcano   <https://k.youshop10.com/74G9Hb6K>
- 多组：FigureYa135multiVolcano <https://k.youshop10.com/e-HIhe8N>，
- 更多散点图：<https://k.youshop10.com/PqTXapih>

The example focuses on PAAD but can be adapted to other TCGA cancer types.

Use a volcano plot to display differential analysis results. Alternatively, more complex volcano plots created by other authors (e.g., FigureYa) can also be utilized.

- A group: FigureYa59volcano <https://k.youshop10.com/spa8oEli>，FigureYa75baseVolcano  <https://k.youshop10.com/74G9Hb6K>
- Multiple group: FigureYa135multiVolcano <https://k.youshop10.com/e-HIhe8N>，
- More scatter plots: <https://k.youshop10.com/PqTXapih>

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

```

# 加载包
# Loading packages

```{r}
library(limma)
library(ggplot2)
library(ggrepel)
library(TCGAbiolinks)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files
TCGA_PAAD_Combined_PDUIs.txt，从synapse网站中下载的TC3A_PDUI（Percentage of Distal polyA site Usage Index）的计算结果。下载网址：<https://doi.org/10.7303/syn24982198>，里面有TCGA其他癌症的PDUI数据，根据自己的研究兴趣灵活运用。

TCGA_PAAD.clin.txt，样本分组信息group。原文未提供分型信息，使用xena下载的样本信息，下载自<https://tcga-xena-hub.s3.us-east-1.amazonaws.com/download/TCGA.PAAD.sampleMap%2FPAAD_clinicalMatrix>

TCGA_PAAD_Combined_PDUIs.txt, the calculation result of TC3A_PDUI (Percentage of Distal polyA site Usage Index) downloaded from the synapse website. Download url: <https://doi.org/10.7303/syn24982198>, there is a TCGA PDUI data of other cancers, according to their own research interests flexible use.

TCGA_PAAD.clin.txt, sample grouping information group. The original text does not provide typing information. The sample information downloaded using xena Download the <https://tcga-xena-hub.s3.us-east-1.amazonaws.com/download/TCGA.PAAD.sampleMap%2FPAAD_clinicalMatrix>
