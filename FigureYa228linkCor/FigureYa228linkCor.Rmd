---
title: "FigureYa228linkCor"
author: "小丫画图出品"
date: "2021-4-16"
output: html_document
---
欢迎关注“小丫画图”公众号，回复“小白”，看小视频，实现点鼠标跑代码。

小丫微信: epigenomics  E-mail: figureya@126.com

作者：大鱼海棠

单位：中国药科大学国家天然药物重点实验室，生物统计与计算药学研究中心

小丫编辑校验

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

老师这个图10D可以众筹吗？真的很漂亮，蝴蝶图

![](example.png)

出自<https://www.thno.org/v11p3089.htm>

Figure 6. Roles of Siglec15 in predicting immune phenotypes in the Xiangya cohort.
(C) Correlations between Siglec15 and the steps of the **cancer immunity cycle**.
(D) Correlations between Siglec15 and the enrichment scores of **immunotherapy-predicted pathways**.

**图的解析**

- 用热图展示通路的自相关分析结果；
- C和D两个热图，分别展示两类通路各自的相关分析结果，放在一起方便对比；
- 用连线展示Siglec15跟两类通路的各个具体通路之间的相关性，实线代表正相关、虚线代表负相关，用颜色代表P value；

# 应用场景

展示相关性分析结果，多对多（C热图、D热图）、1对多（Siglec15跟C的连线，Siglec15跟D的连线）、两组对比（C和D画一起）画一起。

例文是1个基因跟多个通路的相关性，可以替换为1个基因跟多个基因之间、或1个通路跟多个基因之间等等，灵活套用。

如果只有一组，就是单独的C或D；如果有两组，就像例文一样拼成蝴蝶；如果有更多组，同样套用easy_input*文件，画出多个图后，按自己的审美组合。

相关性展示的8种情况及解决方案看这里：<https://mp.weixin.qq.com/s/D9wheY5QdnOh4JrjIc8-Cg>

# 环境设置


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

install.packages("ggnewscale")
install.packages("ade4")
# 下载自https://github.com/hannet91/ggcor
install.packages("ggcor-master.tar.gz", repos = NULL, type = "source")
```

加载包

```{r}
library(data.table)
library(GSVA)
library(ggplot2)
library(ggcor)
Sys.setenv(LANGUAGE = "en") #显示英文报错信息
options(stringsAsFactors = FALSE) #禁止chr转成factor
```

自定义函数（来自cogena），用于提取msigdb特定通路的基因，参考FigureYa151pathifier
