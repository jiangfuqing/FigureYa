---
title: "FigureYa290BarGraph"
params:
  author: "Xiaofan Lu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

想众筹这两个柱状图，重点是不知道一个柱子的不同百分比是怎么做的统计检验。

We want to crowdfund reproduction of these bar graphs, particularly focusing on statistical tests for different percentages within each bar

![](example.png)

出自<https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8627694>

扩展数据图4 | Havcr2fl/fl和Havcr2cko CD45+细胞的单细胞RNA测序。(e) 显示每个cluster中Havcr2fl/fl(蓝)和Havcr2cko(橙)细胞比例的柱状图。

Source: <https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8627694>

Extended Data Fig. 4 |. scRNA-seq of Havcr2fl/fl and Havcr2cko total CD45+ cells. (e) Bar graph showing frequency of Havcr2fl/fl (blue) and Havcr2cko (orange) cells in each cluster.

# 应用场景
# Application scenarios

对单细胞数据进行处理和分型，绘制细胞比例柱状图并做富集检验。

更多单细胞FigureYa看这里<https://k.youshop10.com/McawGY6=>

The single-cell data were processed and typed, the cell proportion bar chart was drawn and enrichment tests were conducted.

More single-cell FigureYa at: <https://k.youshop10.com/McawGY6=>

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

remotes::install_github("mojaveazure/seurat-disk")
install.packages("hdf5r")
```

# 加载包
# Loading packages

```{r}
library(ggplot2)
library(rstatix)
library(Seurat)
library(SeuratDisk)
library(Matrix)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files

例文数据已上传至GEO（GSE151914），下载地址：<https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE151914>

Data available on GEO (GSE151914), download from: <https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE151914>
