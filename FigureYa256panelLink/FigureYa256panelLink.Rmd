---
title: "FigureYa256panelLink"
author: "小丫画图出品"
date: "2021-12-17"
output: html_document
---
欢迎关注“小丫画图”公众号，回复“小白”，看小视频，实现点鼠标跑代码。

小丫微信: epigenomics  E-mail: figureya@126.com

作者：Hazard，他的更多作品看这里<https://k.koudai.com/zuloxG1Y>

小丫编辑校验

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

这个图有机会能众筹一下吗？感觉很强大

![](example.png)

出自<https://doi.org/10.1038/s42255-019-0045-8>

Fig. 7 |. Hypoxia-associated molecular signatures in clinically actionable genes and effects on the response to individual drugs.
(a) Association between FDA-approved drugs and their linked clinically actionable genes (right) and alterations of these genes at mRNA, protein, DNA methylation, mutation and SCNA levels based on hypoxia score-high (red) or hypoxia score-low (blue) samples across 21 cancer types (left). Different symbol shapes represent different types of molecular signatures.
Filled cells indicate that the gene is a therapeutic target of clinical practice in the corresponding cancer type.
Bar plots in right panel indicate the number of cancer types with positive correlation (drug-sensitive, magenta) and negative correlation (drug-resistant, green) between hypoxia score and drug response (Spearman’s correlation).

# 应用场景

跟FigureYa174squareCross和FigureYa199crosslink出自同一篇文章，这篇文章以连线著称。后面我们还会众筹Figure 3c。

该图的优势是将左右两个panel连起来，同时展示多种特征，具体让哪个形状、颜色代表哪些特征，自己可灵活运用。

为了画这个图，完善了crosslink包，该R包会继续添加更多有趣的连线功能，感兴趣可前往<https://github.com/zzwch/crosslink>查看最新版本及功能，在github上还能提交issue跟作者直接交流。

# 环境设置


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

install.packages("remotes")
remotes::install_github("zzwch/crosslink", build = FALSE)
```

加载包

```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
library(crosslink)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息
options(stringsAsFactors = FALSE) #禁止chr转成factor
```

自定义函数

```{r}
revLevels <- function(x, levels = NULL){
  if(is.null(levels)) levels <- rev(sort(unique(x)))
  return(factor(x, levels = levels))
}
```

# 输入文件
