---
title: "FigureYa298ecdfPvalue"
params:
  author: "Qian Liu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirements Description

重点是p值如何算出来的

Focus on how p-values are calculated

![](example.png)

出自：<https://www.nature.com/articles/s41556-018-0045-z>

图2 | IGF2BPs调控全转录组mRNA水平。
(b) IGF2BP基因沉默后，非靶标基因、CLIP靶标基因及CLIP+RIP靶标基因的mRNA log2倍数变化累积频率分布。P值采用**双尾Wilcoxon与Mann–Whitney检验**计算。

Source: <https://www.nature.com/articles/s41556-018-0045-z>

Fig. 2 | IGF2BPs regulate transcriptome-wide mRNA levels.
(b) Cumulative frequency of mRNA log2 FC in non-target, CLIP target and CLIP + RIP target genes upon IGF2BP silencing. P values were calculated using **two-sided Wilcoxon and Mann–Whitney test**.

我们众筹过的FigureYa290BarGraph所在的文章里也用到了类似的图：

The article where the FigureYa290BarGraph we crowdfunded is located also uses a similar graph:

![](example2.png)

出自：<https://www.nature.com/articles/s41586-021-03626-9>

图3 | TIM-3缺陷增强树突细胞功能并促进抗原特异性抗肿瘤免疫。
(d) Havcr2fl/fl(灰色)与Havcr2cko(红色)迁移性树突细胞中mregDC特征基因集富集分数的经验累积分布(ECDF)图(P=9.4×10⁻⁴)
(e) MHC I类抗原呈递特征基因集的ECDF图(P=1.01×10⁻³)
Havcr2fl/fl与Havcr2cko组间基因特征活性水平的差异采用Wilcoxon秩和检验分析，并通过小提琴图或ECDF图可视化

Source: <https://www.nature.com/articles/s41586-021-03626-9>

Fig. 3 | TIM-3 deficiency promotes DC functionality and enhances antigen-specific anti-tumour immunity.
(d) Empirical cumulative distribution function (ECDF) plot of enrichment score for mregDC signature in Havcr2fl/fl (grey) or Havcr2cko (red) migDCs, (P = 9.4 × 10−4). (e) ECDF plot of MHC class I presentation signature (P = 1.01 × 10−3).
The difference in gene signature score activity levels between Havcr2fl/fl and Havcr2cko was examined using **Wilcoxon rank-sum test** and visualized using violin or ECDF plots.

以上两篇文章用到的检验方法`two-sided Wilcoxon and Mann–Whitney test`和`Wilcoxon rank-sum test`是一回事。

The two testing methods mentioned in the above articles, `two-sided Wilcoxon and Mann–Whitney test` and `Wilcoxon rank-sum test`, refer to the same thing.

# 应用场景
# Application Scenario

用经验累积分布函数empirical cumulative distribution function(ECDF)对比分布，并计算两种分布的p value。

ECDF图具有两大核心优势：

- 与直方图或核密度估计不同，它直接呈现每个数据点。这意味着无需考虑分组区间宽度或平滑参数的选择。
- 由于曲线具有单调递增特性，这种图表特别适合进行多组分布的比较。

出自：<https://seaborn.pydata.org/tutorial/distributions.html#tutorial-ecdf>，里面有关于其他分布的介绍，推荐扩展阅读。

我们在FigureYa278heatmapPoints<https://k.youshop10.com/IZWXWn32>中也有类似的一个需求，用的是 `kruskal.test`，这种统计方法也可用来计算两种分布的P值.

Compare distributions using the empirical cumulative distribution function (ECDF) and calculate the p-value between the two distributions.

The ECDF plot has two key advantages.

- Unlike the histogram or KDE, it directly represents each datapoint. That means there is no bin size or smoothing parameter to consider.
- Additionally, because the curve is monotonically increasing, it is well-suited for comparing multiple distributions.

This is from <https://seaborn.pydata.org/tutorial/distributions.html#tutorial-ecdf>, which includes an introduction to other distributions—recommended for further reading.

We had a similar requirement in FigureYa278heatmapPoints <https://k.youshop10.com/IZWXWn32>, where we used the `kruskal.test`. This statistical method can also be used to compute the p-value between two distributions.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

```

# 加载包
# Loading packages

```{r}
library(tidyverse)
library(rstatix)
library(glue)
library(ggtext)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files

easy_input.csv，包含两列，第一列是数值，第二列是分组信息（a、b、c三组）。

The file easy_input.csv contains two columns: the first column stores numerical values, and the second column contains group labels (with three categories: a, b, and c).
