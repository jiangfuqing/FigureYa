---
title: "FigureYa162boxViolin"
author: "Xiaofan Lu"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Description of requirements

绘制两组数据关于某一连续变量的箱型 + 小提琴图
Draw box + violin plots of two sets of data on a continuous variable

![](example.png)

出自<https://clinicalepigeneticsjournal.biomedcentral.com/articles/10.1186/s13148-020-0822-y>
From <https://clinicalepigeneticsjournal.biomedcentral.com/articles/10.1186/s13148-020-0822-y>

Fig. 1 Correlations between DNAm age and chronological age and other molecular characteristics of DNAm age groups. c DNAmAge-ACC group presented with significantly higher HPVpca scores than DNAmAge-DEC group and was inferred to be much more sensitive to two commonly used chemotherapy drugs, i.e. paclitaxel and gemcitabine, as shown in (d) and (e), respectively. The test for association between paired samples used Pearson’s correlation coefficient. Two-tailed statistical P values were calculated by a two-sample Mann-Whitney test or Student’s t test when appropriate

# 应用场景
# Application Scenarios

对比两组或多组数据，原始数据、统计量（boxplot）、统计推断（violin plot, 概率密度）画一起。
Compare two or more sets of data, plotting the original data, statistics (boxplot), and statistical inferences (violin plot, probability density) together.

类似于FigureYa68friends，一半violin、box、一半原始数据。
Similar to FigureYa68friends, half is violin, box, and half is original data.

为什么这样画？原理可参考这篇<https://mp.weixin.qq.com/s/kd-WbPXPrg6K2RFNydK-mQ>。
Why draw this way? For the principle, please refer to this article <https://mp.weixin.qq.com/s/kd-WbPXPrg6K2RFNydK-mQ>

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

```

加载包
Load the package

```{r}
library(ggplot2)
library(ggpubr)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 # Display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor # Disable conversion of chr to factor
```

# 两组比较，原图复现
# Comparison of two groups, reproducing the original image

## 输入文件
## Input file

easy_input.csv，两组的DNA甲基化年龄。第一列是DNA甲基化年龄，第二列是分组。
easy_input.csv, DNA methylation age of the two groups. The first column is DNA methylation age, and the second column is the group.

```{r}
tmp <- read.csv("easy_input.csv", row.names = NULL, check.names = F, header = T, stringsAsFactors = F)
head(tmp)
table(tmp$DNAmAge)
```

## 非参检验
## Nonparametric test

```{r}
p <- wilcox.test(tmp[which(tmp$DNAmAge == "DNAmAge-ACC"),"est.ic50"],tmp[which(tmp$DNAmAge == "DNAmAge-DCC"),"est.ic50"])$p.value
```

## 开始画图
## Start plotting

用ggplot2画图
Plotting with ggplot2
