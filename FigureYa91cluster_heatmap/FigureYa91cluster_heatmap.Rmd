---
title: "FigureY91cluster_heatmap"
author: "Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr的全局代码块选项 / Set global chunk options for knitr
```

## 需求描述

1. 把cluster画到heatmap的顶部，相当于用颜色代替分类的树形结构。

2. 导出聚类后的样本顺序。

3. 让热图中的样本按照文件中的顺序排序。

## Requirement description

1. Draw the cluster to the top of the heatmap, which is equivalent to using colors instead of a hierarchical structure for classification.

2. Export the clustered sample order.

3. Sort the samples in the heatmap according to the order in the file.

![](example.png)

出自<https://www.aging-us.com/article/101829/text>

from<https://www.aging-us.com/article/101829/text>

## 应用场景

1. 为基因表达量、量化的免疫浸润等指标做聚类，突出展示分成2类、3类（也可以更多类）的效果。

2. 导出聚类后的样本顺序，用于后续分析，例如在cluster之间做生存分析。

3. 让热图中的样本按照文件中的顺序排序，例如让样本按照亚型、表型排序。

## Application scenarios

1. Cluster indicators such as gene expression levels and quantified immune infiltration, highlighting the effects of dividing into 2 or 3 categories (or more categories).

2. Export the clustered sample order for subsequent analysis, such as conducting survival analysis between clusters.

3. Sort the samples in the heatmap in the order specified in the file, such as by subtype or phenotype.

## 环境设置


## Environment settings


```r

install.packages("ClassDiscovery")
```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载用于外部聚类分析的R包
# Load the R package for external clustering analysis
library(ClassDiscovery)

# 加载用于绘制热图的R包
# Load the R package for plotting heatmaps
library(pheatmap)

# 加载用于增强热图颜色功能的R包
# Load the R package to enhance heatmap color functionality
library(gplots)

# 设置环境变量，使报错信息以英文显示
# Set environment variable to display error messages in English
Sys.setenv(LANGUAGE = "en")

# 禁止字符串自动转换为因子类型
# Disable automatic conversion of strings to factors
options(stringsAsFactors = FALSE)
```

## 输入文件

## Input file
