---
title: "FigureYa140mosaicPie"
author: "Zongcheng Li"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 需求描述
## Requirement description

输入TCGA数据，画出这种图。
Input TCGA data and draw this kind of graph.

![](example.png)

出自<https://www.cell.com/cancer-cell/pdfExtended/S1535-6108(18)30110-7>
From <https://www.cell.com/cancer-cell/pdfExtended/S1535-6108(18)30110-7>

Figure 2. Epigenetic Landscape of lncRNAs in Cancer(A) Percentages of significant EA (top panel) or ES (bottom panel) lncRNAs in 20 cancer types. Each pie chart indicates the percentage of each lncRNA epigenetic alteration in each cancer type. Purple indicates EA lncRNAs; green indicates ES lncRNAs

(D) Expression of the top 20 EA (top panel) and ES (bottom panel) lncRNAs in cancer cell lines from the CCLE database. Each pie chart indicates the percentage ofcell lines with the lncRNA expressed (purple, absolute read count > 0) or not expressed (green, absolute read count = 0) in each cancer type

See also Figure S2 and Table S2.

**图的解析**
**Analysis of the graph**

- 粉紫色是表观激活EA的lncRNA，绿色是表观抑制ES的lncRNA。
- 纵坐标是表观状态变化频率最高的20个lncRNA，横坐标是癌症组织（A）和Cell line（D）。
- 饼图展示每个lncRNA在每种癌症/cell line里发生表观状态变化的比例。
- Pink and purple are lncRNAs that apparently activate EA, and green are lncRNAs that apparently inhibit ES.
- The vertical axis is the 20 lncRNAs with the highest frequency of epigenetic changes, and the horizontal axis is cancer tissue (A) and Cell line (D).
- The pie chart shows the proportion of epigenetic changes of each lncRNA in each cancer/cell line.

其中A图还分成了High reliability和Intermediate reliability，文章提供了EA和ES信息，但没有提供High reliability和Intermediate reliability的分类信息。这里以文章提供的EA和ES信息作为输入数据，展示画法。
The A graph is also divided into High reliability and Intermediate reliability. The article provides EA and ES information, but does not provide classification information for High reliability and Intermediate reliability. Here, the EA and ES information provided by the article is used as input data to show the drawing method.

另外，还将展示从下载TCGA的DNA甲基化数据（用于定义激活/抑制）到画图。
In addition, it will also show the process from downloading TCGA DNA methylation data (used to define activation/inhibition) to drawing.

## 应用场景
## Application scenario

用饼图展示百分比，再把饼图排成矩阵，就可以对应多组数据。
Use pie charts to show percentages, and then arrange the pie charts into a matrix to correspond to multiple sets of data.

## 环境设置
## Environment settings


```{r}
source("install_dependencies.R")
setRepositories(ind=1:6)
options(repos="http://cran.rstudio.com/")
if(!require(devtools)) { install.packages("devtools") }
library(devtools)

install_github("cBioPortal/cgdsr")
```

加载包
Loading Packages

```{r}
library(readxl)
library(ggplot2)
library(reshape2)
library(cgdsr)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 #Display English error message
options(stringsAsFactors = FALSE) #禁止chr转成factor #Disable conversion of chr to factor
```

自定义画图函数
Custom drawing function
