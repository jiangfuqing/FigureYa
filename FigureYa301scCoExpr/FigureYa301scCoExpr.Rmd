---
title: "FigureYa301scCoExpr"
params:
  author: "Yandong Zheng; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

用来展示单细胞的基因共表达。用2种颜色分别映射2个基因的表达量/连续变量，然后merge展示，有点像免疫荧光实验的merge效果，颜色不是固定值，映射到连续性表达量的也是渐变色。

Used to display gene co-expression in single cells. Two colors are used to map the expression levels/continuous variables of two genes, which are then merged for display, similar to the merge effect in immunofluorescence experiments. The colors are not fixed values but are mapped to continuous expression levels as gradients.

![](Example.png)

出自<https://www.thno.org/v12p3104.htm>

图5. 单细胞RNA测序分析揭示CAF亚群是THBS2的主要来源。

G. UMAP图展示单个CAF中THBS2与FAP的共表达情况。
红色/绿色点分别代表仅表达THBS2+或仅表达FAP+的CAF（左上/中间面板），黄色点表示同时共表达THBS2和FAP的CAF（右上面板）；
左下面板显示不同FAP和THBS2表达水平的CAF之间的**共表达矩阵**；
右下面板展示THBS2+ CAF中THBS2与FAP的**相关性（Pearson）**。
(1) 强相关：Pearson's r ≥ 0.8；
(2) 中等相关：0.5 ≤ Pearson's r < 0.8；
(3) 弱相关：0.3 ≤ Pearson's r < 0.5；
(4) 无相关性：Pearson's r < 0.3。
颜色越深，标记基因的表达水平越高。值得注意的是，仅少数CAF同时高表达THBS2和FAP。

Source: <https://www.thno.org/v12p3104.htm>

Figure 5. scRNA-seq analysis reveals subsets of CAFs as the major source of THBS2 production.

G, UMAP plots showing the co-expression of THBS2 and FAP across individual single CAFs.
Red/green dots represent CAFs expressing THBS2+ only/FAP+ only (upper left/middle panels), respectively, and yellow dots indicate CAFs co-expressing THBS2 and FAP only (upper right panel);
lower left panel showing the **co-expression matrix** across CAFs with different expression of FAP and THBS2;
lower right panels showing the **correlation (Pearson)** between THBS2 and FAP across THBS2+ CAFs.
(1) Strong correlation: Pearson's r ≥ 0.8;
(2) Moderate: 0.5 ≤ Pearson's r < 0.8;
(3) Weak: 0.3 ≤ Pearson's r < 0.5;
(4) No correlation: Pearson's r < 0.3).
The darker the color, the higher the expression level of the indicated markers. Of note, only a minority of CAFs co-express high THBS2 and FAP.

# 应用场景
# Application scenarios

展示单细胞的基因共表达，以及共表达基因相关性。

更多单细胞FigureYa看这里<https://k.youshop10.com/McawGY6=>

相关性展示FigureYa看这里<https://k.youshop10.com/Eig1YOB4>

Displaying gene co-expression in single cells and the correlation of co-expressed genes.

For more single-cell FigureYa, check here<https://k.youshop10.com/McawGY6=>

For correlation visualization FigureYa, check here<https://k.youshop10.com/Eig1YOB4>

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

# devtools::install_github('satijalab/seurat-data')
```

# 加载包
# Loading packages

```{r}
library(Seurat)
library(SeuratData)
library(ggplot2)
library(ggpubr)
library(patchwork)
library(magrittr)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files

使用最常用的SeuratData中的pbmc3k进行演示。

Demonstration using the pbmc3k dataset from the widely adopted SeuratData package.
