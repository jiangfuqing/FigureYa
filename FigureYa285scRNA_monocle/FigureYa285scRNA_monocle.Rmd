---
title: "FigureYa285scRNA_monocle"
params:
  author: "Yandong Zheng; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

画出右图J，拟时间轨迹。

Plot Figure J on the right, showing pseudotime trajectory.

![](example.png)

出自<https://jitc.bmj.com/content/10/2/e003534>

Source: <https://jitc.bmj.com/content/10/2/e003534>

# 应用场景
# Application scenarios

展示如何在单细胞数据中使用monocle2包预测细胞发育轨迹。

Show how to use the monocle2 package in single-cell data to predict cell developmental trajectories.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

BiocManager::install("monocle")
install.packages("https://cran.r-project.org/src/contrib/Archive/igraph/igraph_2.0.3.tar.gz",repos = NULL)
```

# 加载包
# Loading packages

```{r}
library(Seurat)
library(SeuratData)
library(ggplot2)
library(RColorBrewer)
library(dplyr)
library(magrittr)
library(monocle)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件及预处理
# Input Files and Preprocessing

## 输入文件
## Input Files

使用最常用的SeuratData中的pbmc3k进行演示，如果自己的数据不是在seurat中分析的，只要有表达矩阵和细胞注释信息也可分析，可跳过下面seurat常规分析，直接运行“构建monocle对象”。

由于pbmc数据并不适合分析发育轨迹，本示例只展示如何计算，不探究具体科学问题。

建议对自己数据中**存在发育关系的细胞群**进行发育轨迹预测。

This demonstration uses the pbmc3k dataset from SeuratData. If your data was not analyzed in Seurat but you have an expression matrix and cell annotation information, you can skip the standard Seurat analysis steps below and directly proceed to "Constructing the monocle object".

Since the PBMC dataset is not ideal for studying developmental trajectories, this example only illustrates the computational steps rather than exploring specific biological questions.

For your own data, it is recommended to predict developmental trajectories only for **cell populations with potential developmental relationships**.
