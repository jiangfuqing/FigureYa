---
title: "FigureYa219GMM"
author: "Xiaofan Lu"
reviewers: "Ying Ge,Hui Huang"
date: "2025-5-20"
output: html_document
---
# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

这篇文章里用了高斯混合模型，从10个候选miRNA筛出了8个，并且获得了每个miRNA的系数，计算riskscore。

# Requirement Description

In this paper, a Gaussian mixture model was used to screen out 8 of the 10 candidate miRNAs, and the coefficients for each miRNA were obtained to calculate the riskscore.

![](example.png)

出自<https://www.thno.org/v10p8771.pdf>
from<https://www.thno.org/v10p8771.pdf>

Figure 4. The pattern of AUC and 1023 logistic regression models were based on Gaussian finite mixture models.
(A) The pattern of the logistic regression model correlated with the AUC scores and was identified by a Gaussian mixture. There are eight clusters of 1023 combinations.

# 应用场景

通过排列组合构建所有可能的逻辑回归并计算每个模型下的AUC，通过高斯混合模型聚类确定最优模型簇，并根据最高AUC得到最终预测模型。

# Application Scenarios

All possible logistic regressions were constructed through permutations and combinations, and the AUC under each model was calculated, the optimal model cluster was determined by Gaussian mixture model clustering, and the final prediction model was obtained according to the highest AUC.

# 环境设置


# Environment settings


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

BiocManager::install("miRBaseVersions.db")
BiocManager::install("miRBaseConverter")
BiocManager::install("SimDesign")
```

加载包
load packages

```{r}
library(mclust)
library(miRBaseVersions.db)
library(miRBaseConverter)
library(pROC)
library(SimDesign)
source("twoclasslimma.R") #差异表达分析 # Differential expression analysis
Sys.setenv(LANGUAGE = "en") #显示英文报错信息 # error messages are displayed in English
options(stringsAsFactors = FALSE) #禁止chr转成factor # chr is not allowed to be converted to factor
```

自定义函数
Custom functions

```{r}
display.progress = function (index, totalN, breakN=20) {

  if ( index %% ceiling(totalN/breakN)  ==0  ) {
    cat(paste(round(index*100/totalN), "% ", sep=""))
  }
}
```

# 输入文件

分别从TCGA和来自GEO的数据集提取三阴性乳腺癌和**癌旁样本**。提取二者共有的miRNA，用于后续分析。

- TCGA的miRNA数据
  - BRCA-miRNA.txt，TCGA-miRNA表达矩阵。
  - tcga.sinfo.txt，TCGA数据样本信息。
- 来自GEO的miRNA芯片数据
  - gse40525.expr.txt，GSE40525表达矩阵。
  - gse40525.sinfo.txt，GSE40525样本信息。

# Input files

Triple-negative breast cancer and **paracancerous samples** were extracted from TCGA and datasets from GEO, respectively. miRNAs common to both were extracted for subsequent analysis.

- miRNA data for TCGA
- BRCA-miRNA.txt, TCGA-miRNA expression matrix.
- tcga.sinfo.txt. TCGA data sample information.
- miRNA microarray data from GEO
- gse40525.expr.txt, GSE40525 expression matrix.
- gse40525.sinfo.txt, GSE40525 sample information.
