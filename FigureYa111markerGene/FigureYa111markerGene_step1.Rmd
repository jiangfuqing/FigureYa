---
title: "FigureYa111markerGene_step1"
author: "Zhougeng Xu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr代码块的全局选项 / Set global options for knitr code chunks
```

## 需求描述

用Seurat找marker基因，用scanpy画出文章里这种热图，中间顺利衔接。

## Requirement description

Use Seurat to find marker genes, and use scanpy to draw this heatmap in the article, smoothly connecting the middle.

![](example.png)

出自<https://www.nature.com/articles/s41586-019-0933-9>

from<https://www.nature.com/articles/s41586-019-0933-9>

Fig. 2d, Heat map illustrating the row-normalized mean expression of marker genes for each maturing gut cluster.

## 应用场景

本文档用Seurat进行单细胞上游分析，得到聚类信息和聚类注释信息，使用我写的函数保存结果，然后打开FigureYa111markerGene.ipynb文件，用Scanpy画美图。

这里是前面用Seurat，后面只是用scanpy的画图功能。当然你也可以从头到尾都用Scanpy来做，这个不包含在本文档范围内。

## Application scenarios

This document uses Seurat for single-cell upstream analysis to obtain clustering information and cluster annotation information. Use the function I wrote to save the results, then open the FigureYa111markerGene.ipynb file and draw a beautiful image using Scanpy.

Here, Seurat was used earlier, and only the drawing function of scanpy was used later. Of course, you can also use Scanpy from start to finish, which is not included in the scope of this document.

## 环境设置

要求:

- 操作系统: Windows10（内存64G)的运行环境是WSL， MacOS，Linux(Ubuntu/CentOS)，
- 电脑内存: 最低8G， 推荐16G起步，上不封顶
- 掌握shell的基本使用方法

安装Seurat包

## Environment settings

requirement:

-Operating System: The operating environment for Windows 10 (64GB of memory) is WSN, MacOS, Linux (Ubuntu/CentOS),
-Computer memory: minimum 8GB, recommended starting at 16GB, with no upper limit
-Master the basic usage of shell

Install Seurat package

```r
install.packages('Seurat')
```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载dplyr包，提供数据处理和转换的函数
# Load the dplyr package, which provides functions for data manipulation and transformation
library(dplyr)

# 加载Seurat包，用于单细胞RNA测序数据分析
# Load the Seurat package, which is used for single-cell RNA sequencing data analysis
library(Seurat)

# 设置环境变量，使R显示英文错误信息，便于统一错误排查的语言
# Set the environment variable to display error messages in English for consistency in troubleshooting
Sys.setenv(LANGUAGE = "en")

# 设置选项，禁止将字符型变量自动转换为因子类型，避免意外的数据转换
# Set an option to prevent automatic conversion of character variables to factors,
# avoiding unexpected data type conversions
options(stringsAsFactors = FALSE)
```

## 输入文件

示例文件保存在当前文件夹下的filtered_gene_bc_matrices/hg19/文件夹里

## Input file

The example file is saved in the filtered_gene-bc_tricks/hg19/folder in the current folder
