---
title: "FigureYa193RiskTable"
author: "Xiaofan Lu"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---
# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

# Requirement

上半部分是TCGA数据，下半部分是用GEO数据集验证，riskscore用多因素cox或lasso都行。搞一个GEO验证集就好了，例文的两个GEO数据都是类似的，我们比葫芦画瓢。
The upper part is TCGA data, and the lower part is verified using the GEO dataset. riskscore can be achieved using either multivariate cox or lasso. Just set up a GEO validation set. The two GEO data in the example are similar. Let's imitate them.

![](example.png)

出自<https://translational-medicine.biomedcentral.com/articles/10.1186/s12967-019-1824-4>
fromhttps://translational-medicine.biomedcentral.com/articles/10.1186/s12967-019-1824-4

# 应用场景

# Application Scenarios

训练集构建riskscore并验证，采用多变量回归检验预后独立性并绘制森林图。
The riskscore of the training set was constructed and verified. Multivariate regression was used to test the prognostic independence and a forest map was drawn.

# 环境设置

# Environment Setup


```{r}
source("install_dependencies.R")

```

加载包
Loading package

```{r}
library(survival) # 生存分析  # Survival Analysis
library(glmnet) # LASSO回归   # LASSO Regression
library(forestplot) # 绘制森林图   # Draw forest maps

Sys.setenv(LANGUAGE = "en") #显示英文报错信息  # displays an English error message
options(stringsAsFactors = FALSE) #禁止chr转成factor  # prohibit chr from being converted to factor
```

自定义函数显示进程
Custom functions display processes

```{r}
display.progress = function (index, totalN, breakN=20) {
  if ( index %% ceiling(totalN/breakN)  ==0  ) {
    cat(paste(round(index*100/totalN), "% ", sep=""))
  }
}
```

# 输入文件

# Input File

需要表达矩阵和生存信息。表达矩阵文件较大，请到微云下载：
The matrix and survival information need to be expressed. The expression matrix file is quite large. Please download it from Weiyun
<https://share.weiyun.com/92trvp7M>

这里用TCGA数据做训练集，用从GEO数据库下载的一组表达数据做测试集。如果你用多组GEO数据或自己的表达数据做测试集，就依次添加。
Here, TCGA data is used as the training set, and a set of expression data downloaded from the GEO database is used as the test set. If you use multiple sets of GEO data or your own expression data as test sets, add them one by one.

- tcga.expr.txt，TCGA的表达矩阵；
  tcga.expr.txt, the expression matrix of TCGA.
- tcga.surv.txt，TCGA的生存数据。
  tcga.surv.txt, survival data of TCGA.
- gse39582.expr.txt，GEO的表达矩阵；
  gse39582.expr.txt, the expression matrix of GEO.
- gse39582.surv.txt，GEO的生存数据。
  gse39582.surv.txt, survival data of GEO.
