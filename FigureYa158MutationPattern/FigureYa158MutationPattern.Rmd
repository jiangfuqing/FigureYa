---
title: "FigureYa158MutationPattern"
author: "Rongfang Shen"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirement Description

输入TCGA突变数据，用非负矩阵分解方法NMF分析突变特征，重复出如下图。
Input TCGA mutation data and analyze mutation signatures using the non-negative matrix factorization (NMF) method, producing the following image.

![](example.png)

出自<https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4610178/>
From <https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4610178/>

# 应用场景
# Application Scenario

突变特征定义：体细胞突变是多个突变过程如DNA修复缺陷，暴露于外源或内源诱变剂等综合结果。不同的突变过程会产生不同组合的突变类型，即突变特征。利用突变特征分析感兴趣癌种突变特征，探讨其可能的发生病因及机制。
目前已经有很多的R包可以帮助我们完成mutation signature分析如MutationalPatterns,maftools,deconstructSigs ,SomaticSignatures.
Mutation signature definition: Somatic mutations are the combined result of multiple mutational processes, such as DNA repair defects and exposure to exogenous or endogenous mutagens. Different mutational processes produce different combinations of mutation types, known as mutation signatures. Mutation signatures are used to analyze the mutational characteristics of cancers of interest and explore their potential causes and mechanisms.
Currently, many R packages exist to assist with mutation signature analysis, such as MutationalPatterns, maftools, deconstructSigs, and SomaticSignatures.

在这里我们选用maftools + MutationalPatterns来完成分析。
Here, we use maftools + MutationalPatterns to perform this analysis.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")
```

```{r, eval=FALSE}

BiocManager::install("MutationalPatterns")
BiocManager::install("BSgenome")
BiocManager::install("BSgenome.Hsapiens.UCSC.hg38")
install.packages("tidyverse")
install.packages("haven")
```

加载包
Load package

```{r}
library(MutationalPatterns)
library(TCGAbiolinks)
library(maftools)
library(magrittr)
library(stringr)
library(NMF)
library(ggsci)
library(BSgenome)
library(ggplot2)
library(cowplot)
library(BSgenome.Hsapiens.UCSC.hg38)
Sys.setenv(LANGUAGE = "en") #显示英文报错信息
options(stringsAsFactors = FALSE) #禁止chr转成factor
```

# 输入文件的下载
# Download input files

用TCGAbiolinks下载突变信息、临床数据
Download mutation information and clinical data using TCGAbiolinks
