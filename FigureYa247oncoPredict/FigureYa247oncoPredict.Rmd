---
title: "FigureYa247oncoPredict"
author: "Xiaofan Lu"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述 Demand Description

想众筹一下刚出的oncoPredict包的用法。pRRophetic包的升级版，表达谱药物敏感性评估的。用FigureYa105GDSC的输入文件，画出同一类型的图。 I’d like to crowdsource how to use the newly released oncoPredict package. It’s an upgraded version of pRRophetic for evaluating drug sensitivity from expression profiles. Use the input files from FigureYa105GDSC to produce the same type of plots.

![](example.png)

出自<https://www.sciencedirect.com/science/article/pii/S1476558619301307>
From https://www.sciencedirect.com/science/article/pii/S1476558619301307

注意：由于包含原文数据，若涉及到注释文件亚型及其他相关数据的使用，请引用： Note: Since original data are included, if subtype annotations or other related data are used, please cite:
Lu X, Jiang L, Zhang L, et al. Immune Signature-Based Subtypes of Cervical Squamous Cell Carcinoma Tightly Associated with Human Papillomavirus Type 16 Expression, Molecular Features, and Clinical Outcome[J]. Neoplasia, 2019, 21(6): 591-601. Lu X, Jiang L, Zhang L, et al. Immune Signature-Based Subtypes of Cervical Squamous Cell Carcinoma Tightly Associated with Human Papillomavirus Type 16 Expression, Molecular Features, and Clinical Outcome[J]. Neoplasia, 2019, 21(6): 591-601.

# 应用场景 Application Scenario

发布oncoPredict包的文章https://academic.oup.com/bib/advance-article/doi/10.1093/bib/bbab260/6321360 The article releasing the oncoPredict package https://academic.oup.com/bib/advance-article/doi/10.1093/bib/bbab260/6321360

oncoPredict包把三个方法包装成三个函数：GLDS, calcPhenotype and IDWAS，官方用法文档看这里：https://cran.r-project.org/web//packages/oncoPredict/index.html The oncoPredict package wraps three methods as three functions: GLDS, calcPhenotype, and IDWAS; see the official usage docs here: https://cran.r-project.org/web//packages/oncoPredict/index.html

This functionality (指的是calcPhenotype函数) is similar to our original pRRophetic package [13] but has been overhauled to enable faster implementation, provides updated CTRP and GDSC screening data and allows for increased user customization. This functionality (referring to the calcPhenotype function) is similar to our original pRRophetic package [13] but has been overhauled to enable faster implementation, provides updated CTRP and GDSC screening data and allows for increased user customization.

这里采用oncoPredict包里的calcPhenotype函数来通过细胞系表达谱预测肿瘤样本药物敏感性。 Here we use the calcPhenotype function in oncoPredict to predict tumor sample drug sensitivity from cell line expression profiles.

> oncoPredict和pRRopetic的异同： Similarities and differences between oncoPredict and pRRophetic:

从算法角度看起来oncoPredict和pRRopetic没什么区别，只是更快了一些。 From an algorithmic perspective oncoPredict and pRRophetic are largely similar, but oncoPredict is faster.
oncoPredict可以通过细胞系表达谱预测肿瘤样本药物敏感性。 oncoPredict can predict tumor sample drug sensitivity using cell line expression.
对于不使用自定义细胞系表达/药敏的小伙伴来说，pRRopetic包会更友好，内置GDSC数据。pRRophetic的用法可参考FigureYa105GDSC，根据GDSC细胞系表达谱和TCGA基因表达谱构建岭回归模型预测药物IC50。 For those not using custom cell line expression/sensitivity data, pRRophetic is more user-friendly with built-in GDSC data. See FigureYa105GDSC for usage: build a ridge regression model using GDSC cell line expression and TCGA gene expression to predict drug IC50.
FigureYa212drugTarget也用了pRRophetic。根据PRISM和CTRP2.0药物敏感性AUC值数据、以及CCLE表达谱数据，预测TCGA亚组潜在性治疗药物。不同于FigureYa105GDSC，这个数据是药物敏感性AUC值，以及药物的范围更加广泛。 FigureYa212drugTarget also used pRRophetic. Using PRISM and CTRP2.0 drug sensitivity AUC data plus CCLE expression, it predicted potential therapeutics for TCGA subgroups. Unlike FigureYa105GDSC, this uses AUC values and covers a broader drug space.

还可以不用这两个R包，从TCGA表达谱分出的亚型推演到GDSC数据库里的细胞系，由此推出各亚型的药物敏感性，可参考FigureYa246supervisedGDSC。 You can also skip both R packages: project TCGA-derived subtypes onto GDSC cell lines to infer subtype-specific drug sensitivity; see FigureYa246supervisedGDSC.

或者使用在线工具CMap，任何感兴趣的差异基因都可以用CMap分析得到靶向干性特征的潜在化合物/抑制剂，可参考FigureYa131CMap。 Or use the online tool CMap: any differential genes of interest can be analyzed to obtain potential compounds/inhibitors targeting stemness features; see FigureYa131CMap.

自己的数据，可以都跑跑看。 For your own data, try running all of them.

# 环境设置 Environment Setup


```{r}
source("install_dependencies.R")

BiocManager::install("sva")
```

加载包 Load packages
