---
title: "FigureYa263panDiff"
params:
  author: "Xiaofan Lu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

小丫姐好，我还有很多小伙伴想众筹这篇铁死亡泛癌的其他图片，主要是Figure 1。感觉这个套路只要换一个通路就可以测试，我看大鱼老师写了这篇文章的Figure 2A（铁死亡基因在泛癌肿瘤与正常的差异箱线图，FigureYa208FPI），Figure 3B（铁死亡与免疫通路的相关性，FigureYa253panGSEA），可否请大鱼老师详细写一下文章Figure 1的相关代码？

- 1A（铁死亡在泛癌中体细胞拷贝数变异情况，绘制条形图）
- 1B（铁死亡基因在肿瘤与正常的差异表达，绘制拼接的点图和柱状图）
- 1C（铁死亡基因体细胞拷贝数与基因表达的相关性点图）
- 1D（铁死亡基因肿瘤与正常组织甲基化状态点图）
- 1E（铁死亡转录组表达与启动子甲基化相关性的点图）

这些图都是泛癌的，不知道大鱼老师可不可以用例文数据分别众筹个教程？（感觉都可以出一期专栏——iSicence复现了哈哈）

这次众筹Figure 1B，铁死亡基因在肿瘤与正常的差异表达，绘制拼接的点图和柱状图。

Hi Xiaoya, many of us would like to crowdsource other figures from this pan-cancer ferroptosis paper, especially Figure 1. This analytical framework seems easily adaptable - just switch the pathway for testing. I noticed Teacher Dayu has already shared code for Figure 2A (boxplots showing differential expression of ferroptosis genes in tumors vs normals across cancers, FigureYa208FPI) and Figure 3B (correlation between ferroptosis and immune pathways, FigureYa253panGSEA). Could Teacher Dayu please provide detailed code for Figure 1?

- 1A (somatic copy number alterations of ferroptosis genes across cancers, bar plot)
- 1B (differential expression of ferroptosis genes in tumors vs normals, composite dot and bar plots)
- 1C (correlation scatter plot between somatic copy number and gene expression of ferroptosis genes)
- 1D (methylation status scatter plot of ferroptosis genes in tumor vs normal tissues)
- 1E (scatter plot showing correlation between transcriptomic expression and promoter methylation of ferroptosis genes)

Since these are all pan-cancer analyses, could Teacher Dayu create separate tutorials using the example data? (This could even become a column - "iScience Replication"!)

This time we're crowdsourcing Figure 1B: differential expression of ferroptosis genes in tumors vs normals, to create composite dot and bar plots.

![](example.png)

出自：<https://linkinghub.elsevier.com/retrieve/pii/S2589004220304892>

图1. 铁死亡调控基因(FRGs)的异常表达。
其中正调控因子和负调控因子分别用红色和蓝色标记。
(B) 柱状图(上图)显示显著差异表达基因的数量，热图展示各癌症中FRGs的倍数变化和FDR值。显著上调和下调的基因分别用红色和绿色标记。

Source: <https://linkinghub.elsevier.com/retrieve/pii/S2589004220304892>

Figure 1. The Dysregulation of Ferroptosis Regulator Genes (FRGs).
For which the positive and negative regulators are marked in red and blue, respectively.
(B) Histogram (upper panel) shows the number of significantly differentially expressed genes, and the heatmap shows the fold change and FDR of FRGs in each cancer. Significantly upregulated and downregulated genes are marked in red and green, respectively.

# 应用场景
# Application scenarios

分析基因在肿瘤与正常组织中的差异表达情况并绘制拼接的点图与柱状图。

更多pancancer分析画图FigureYa看这里<https://k.youshop10.com/C8RkTgR3>

Analyze differential gene expression between tumor and normal tissues and generate composite dot plots with bar charts.

For more pan-cancer analysis and visualization tools (FigureYa series), visit <https://k.youshop10.com/C8RkTgR3>

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

BiocManager::install("impute")
```

# 加载包
# Loading packages

```{r}
library(ggplot2)
library(data.table)
library(randomcoloR)
library(ggpubr)
library(GSVA)
library(clusterProfiler)
library(impute)
library(ComplexHeatmap)
source("twoclasslimma.R")

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files

跟FigureYa253panGSEA使用的是同一套数据，已经下载的小伙伴就不用重复下载了。

merged_sample_quality_annotations.tsv，下载自<https://gdc.cancer.gov/about-data/publications/pancanatlas>，下载地址<http://api.gdc.cancer.gov/data/1a7d7be8-675d-4e60-a105-19d4121bdebf>

EBPlusPlusAdjustPANCAN_IlluminaHiSeq_RNASeqV2.geneExp.tsv，表达矩阵，第一列是基因，之后是其在每个样本中的表达量。下载自<http://api.gdc.cancer.gov/data/3586c0da-64d0-4b74-a449-5ff4d9136611>。

The same dataset as used in FigureYa253panGSEA is applied here - those who have already downloaded it need not download again.

merged_sample_quality_annotations.tsv, downloaded from <https://gdc.cancer.gov/about-data/publications/pancanatlas>, download link<http://api.gdc.cancer.gov/data/1a7d7be8-675d-4e60-a105-19d4121bdebf>

EBPlusPlusAdjustPANCAN_IlluminaHiSeq_RNASeqV2.geneExp.tsv, expression matrix with genes in the first column followed by their expression values in each sample. Downloaded from<http://api.gdc.cancer.gov/data/3586c0da-64d0-4b74-a449-5ff4d9136611>
