---
title: "FigureYa83enrichment"
author: "Haitao Wang, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr的全局代码块选项 / Set global chunk options for knitr
```

## 需求描述

## Requirement Description

Enrichment for Molecular Concept Map, to identify significant association within lists of TF genes。

通过转录因子靶基因的集合，用Fisher's exact test分析转录因子间的coupling（耦合、共调控），在形式上模仿paper里的这种图来展示结果：

Analyze coupling (coupling, co-regulation) between transcription factors by means of a collection of transcription factor target genes using Fisher's exact test, and present the results in a form that mimics this kind of map in a paper:

![](example.png)

出自<http://www.bloodjournal.org/content/128/5/686?sso-checked=true>

from<http://www.bloodjournal.org/content/128/5/686?sso-checked=true>

## 应用场景

分析任意集合之间的关系，例如转录因子之间（示例数据）、差异表达基因跟通路之间、染色质开放跟基因转录之间。

场景一：找转录因子之间的耦合关系（共同调控靶基因），例如示例数据(Interactions.RData)是201个转录因子，以及每个转录因子对应的多个有相互作用的基因。

场景二：差异表达基因在通路里的富集，就把差异表达基因跟通路里的基因都放到Interactions.RData里。例如：

$up_regulated_genes
[1] "ZBTB38" "SRA1"   "IPO13"  "ALX4"   "EP300"  "CREBBP" "IPO13"

$MAPK_pathway
  [1] "ESR2"     "ZNF688"   "BANP"     "ISYNA1"   "TBC1D7"

场景三：分析染色质开放程度跟基因转录调控之间的关系，就把ATAC-seq peak附近的基因跟差异表达基因都放到Interactions.RData里。例如：

$up_regulated_genes
[1] "ZBTB38" "SRA1"   "IPO13"  "ALX4"   "EP300"  "CREBBP" "IPO13"

$ATAC-seq_peak
  [1] "ESR2"     "ZNF688"   "BANP"     "ISYNA1"   "TBC1D7"

## Application Scenarios

Analyze the relationship between any sets, such as between transcription factors (example data), between differentially expressed genes and pathways, between chromatin opening and gene transcription.

Scenario 1: Find the coupling relationship between transcription factors (co-regulation of target genes), e.g. the example data (Interactions.RData) is 201 transcription factors, and multiple interacting genes corresponding to each transcription factor.

Scenario 2: Enrichment of differentially expressed genes in a pathway, put the differentially expressed genes and the genes in the pathway into Interactions.RData. Example:

$up_regulated_genes
[1] “ZBTB38” “SRA1” “IPO13” “ALX4” “EP300” “CREBBP” “IPO13”

$MAPK_pathway
  [1] “ESR2” “ZNF688” “BANP” “ISYNA1” “TBC1D7”

Scenario 3: To analyze the relationship between chromatin openness and gene transcriptional regulation, put the genes near the ATAC-seq peak and the differentially expressed genes into Interactions.RData. RData. For example:

$up_regulated_genes
[1] “ZBTB38” “SRA1” “IPO13” “ALX4” “EP300” “CREBBP” “IPO13”

$ATAC-seq_peak
  [1] “esr2” “znf688” “banp” “isyna1” “tbc1d7”

## 环境设置


## Environment settings


```r

install.packages("rentrez")
```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载rentrez包，用于访问NCBI数据库进行文献检索和数据获取
# Load the rentrez package for accessing NCBI databases for literature retrieval and data acquisition
library(rentrez)

# 加载RColorBrewer包，提供丰富的色彩方案用于数据可视化
# Load the RColorBrewer package, which provides a variety of color schemes for data visualization
library(RColorBrewer)

# 加载corrplot包，用于绘制相关性矩阵图
# Load the corrplot package for plotting correlation matrix diagrams
library(corrplot)

# 加载ggplot2包，强大的数据可视化工具
# Load the ggplot2 package, a powerful data visualization tool
library(ggplot2)

# 加载ggthemes包，提供额外的ggplot2主题和样式
# Load the ggthemes package, which provides additional themes and styles for ggplot2
library(ggthemes)

# 导入自定义函数文件
# Import custom function file
source("my_function.R")

# 设置环境变量，使R显示英文错误信息
# Set environment variable to display English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止字符串自动转换为因子类型，避免意外的数据类型转换
# Disable automatic conversion of strings to factors to avoid unexpected data type conversions
options(stringsAsFactors = FALSE)
```

## 输入文件的获得

如果你有自己的相互作用的基因list，保存在Interactions.RData里，就可以跳过这步，直接进入“Fisher's Exact Test”。

easy_input_TF.csv，此处用201个转录因子的gene symbol，可以替换成你感兴趣的基因的gene symbol，例如差异表达基因、差异表达lncRNA等。

easy_input_bg.csv，背景gene sybol，可以替换成与你感兴趣的基因相对应的背景基因，例如基因组上的全部基因、全部lncRNA等。
