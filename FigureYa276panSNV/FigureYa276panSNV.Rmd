---
title: "FigureYa276panSNV"
params:
  author: "Xiaofan Lu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

我们希望复现pancancer SNV

We desired to reproduce pan-cancer SNV analysis

![](example.png)

出自：<https://onlinelibrary.wiley.com/doi/10.1111/jpi.12758>

图2 褪黑素调节因子的单核苷酸变异(SNV)频率及变异类型。
(A) 褪黑素调节因子的突变频率。数值表示特定癌症中对应基因发生突变的样本数量。"0"表示该基因编码区未检测到突变，空白则表示该基因任何区域均未发现突变。
(B) SNV突变景观图。展示褪黑素调节因子突变分布及SNV类型分类的热图。

Source: <https://onlinelibrary.wiley.com/doi/10.1111/jpi.12758>

FIGURE 2 Single nucleotide variation(SNV) frequency and variant types of melatonergic regulators.
(A)Mutation frequency of melatonergic regulators. Numbers represent the number of samples that have the corresponding mutated gene for a given cancer. “0” indicates that there was no mutation in the gene coding region, and no number indicates there was no mutation in any region of the gene.
(B) SNV oncoplot. An oncoplot showing the mutation distribution of melatonergic regulators and a classification of SNV types.

# 应用场景
# Application scenarios

分析泛癌中特定通路基因的突变情况。

更多pancancer分析和可视化看这里<https://k.youshop10.com/C8RkTgR3>

Analysis of mutation patterns in specific pathway genes across pan-cancer.

For more pancancer analysis and visualization resources, visit: <https://k.youshop10.com/C8RkTgR3>

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

BiocManager::install("maftools")
```

# 加载包
# Loading packages

```{r}
library(tidyverse)
library(magrittr)
library(readxl)
library(stringr)
library(ggplot2)
library(maftools)
library(dplyr)
library(reshape2)
library(RColorBrewer)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files

mc3.v0.2.8.PUBLIC.maf.gz，TCGA pancancer突变数据，下载自<https://gdc.cancer.gov/about-data/publications/pancanatlas> Mutations，下载地址<http://api.gdc.cancer.gov/data/1c8cfe5f-e52d-41ba-94da-f15ea1337efc>

merged_sample_quality_annotations.tsv，下载自<https://gdc.cancer.gov/about-data/publications/pancanatlas>，下载地址<http://api.gdc.cancer.gov/data/1a7d7be8-675d-4e60-a105-19d4121bdebf>。跟FigureYa263panDiff、FigureYa265panCNV、FigureYa268panCNVexpr使用的是同一套数据，已经下载的小伙伴就不用重复下载了。

mc3.v0.2.8.PUBLIC.maf.gz, TCGA
pancancer mutation data, downloaded from <https://gdc.cancer.gov/about-data/publications/pancanatlas>.
Mutations, download link <http://api.gdc.cancer.gov/data/1c8cfe5f-e52d-41ba-94da-f15ea1337efc>.

merged_sample_quality_annotations.tsv, downloaded from <https://gdc.cancer.gov/about-data/publications/pancanatlas>, download link <http://api.gdc.cancer.gov/data/1a7d7be8-675d-4e60-a105-19d4121bdebf>. The same dataset is used in FigureYa263panDiff, FigureYa265panCNV, and FigureYa268panCNVexpr. Friends who have already downloaded it don't need to download again.
