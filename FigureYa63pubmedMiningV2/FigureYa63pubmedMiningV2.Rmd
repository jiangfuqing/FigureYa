---
title: "FigureYa63 PubmedMiningV2"
author: "Haitao Wang, Melvin L.K. Chua; Ying Ge, Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 需求描述
## Requirement description

通过API检索NCBI的Pubmed数据库，批量获得文章信息，整理出摘要里基因的词频。

NCBI's Pubmed database is searched through the API to obtain article information in bulk and organize the word frequencies of the genes in the abstracts.

## 应用场景
## Application scenario

- 老板交给我的这个基因好陌生，用这套代码跑出表格，一眼望去，发现它的好朋友我都很熟，于是，熟悉的思路、方法都能用上了。
- 文章做到第三部分卡住了，我的基因到底调控了谁，或者谁调控了它，或者它跟谁是好朋友一同发挥作用？用这套代码跑出表格，一眼望去，发现目的基因跟我熟悉的一类分子一同出现在某篇文章的摘要里，我们实验室有非常完善的研究这类分子的实验体系，接下来就瞄准这个分子了。

只要设置好检索词，就可以批量检索并整理文献和摘要，让你的头脑风暴比别人快10倍。

包含三个模块，相对独立，可分别运行。全部运行完将让你对目的基因有个整体的认识。

【模块一】文章的增长趋势

【模块二】发表了哪些文章

【模块三】**从摘要找好朋友**

- The gene my boss handed to me is quite unfamiliar. Using this set of code to generate a table, at a glance, I found that I am very familiar with its good friends, so I can apply familiar ideas and methods.

- The article got stuck at the third part. Exactly which gene is regulated by mine, or who regulates it, or with whom does it cooperate to function? Running this set of code to generate a table, at a glance, I found the target gene appearing alongside a familiar class of molecules in the abstract of a certain article. Our laboratory has a very comprehensive experimental system for studying this class of molecules, so the next step is to focus on this molecule.

As long as you set the search terms, you can batch search and organize the literature and abstracts, so that your brainstorming is 10 times faster than others.

It contains three modules that are relatively independent and can be run separately. All run through will give you an overall understanding of the target gene.

[Module 1] Trends in the growth of articles

[Module 2] What articles are published

[Module 3] **Find a good friend from the abstract**

## 环境设置
## Environment setting


```r

BiocManager::install("rentrez")
BiocManager::install("pubmed.mineR")
install.packages("jiebaR")
install.packages("bibliometrix")
install.packages("DT")
install.packages("htmlwidgets")
```

加载包

load package

```{r}
source("install_dependencies.R")
library(data.table)
library(stringr)
library(ggplot2)
library(jiebaR)
library(rentrez)
library(pubmed.mineR)
library(bibliometrix)
library(ggrepel)
library(ggthemes)
library(AnnotationDbi)
library(DT)
library(htmlwidgets)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor prohibit the conversion of chr to factor
```

### 输入文件
### Input file

#### 常用词
#### Common words

common_words_new.v2.txt，常用词。【模块三】计算词频时，要去除这些常用词。

common_words_new.v2.txt, common words. [Module 3] These common words are removed when calculating word frequency.

```{r}
common_words_new <- read.table("common_words_new.v2.txt")
common_words_new <- common_words_new$V1
```

#### 基因名
#### Gene name

每行一个基因。包含基因名、别名、位点，【模块三】将从摘要中统计这些基因名。还可以换成你想统计词频的其他类型的词。

One gene per row. It contains gene names, aliases, and loci. [Module 3] will count these gene names from the abstract. You can also replace them with other types of words for which you want to count frequency.

```{r}
(load("HGNCdata.rda")) #位于当前文件夹 located in the current folder
head(HGNCdata)
```


## 参数设置
## Parameter setting

在这里设置检索词、检索的文章发表时间范围

set search terms and the publication time range of the retrieved articles here

```{r}
targetGene <- "PD-L1" #检索的基因名 retrieved gene names
year <- 2010:2018 #检索的文章的发表年份范围 the publication year range of the retrieved articles
```

这里用的检索词跟你在网页版Pubmed中用的检索词是一样的，初级用法就是用AND或OR连接你希望检索到的内容，例如基因名、疾病、处理、物种等。医学领域推荐直接用MeSH terme来限定，Medical Subject Headings(MeSH) refer to wiki <https://en.wikipedia.org/wiki/Medical_Subject_Headings>

如果用基因名作为检索词，建议把基因的别名都放进来，可以通过下面的代码提取：

The search terms used here are the same as those you would use in the web version of Pubmed, and the primary use is to connect what you wish to retrieve with AND or OR, such as gene name, disease, treatment, species, etc. In the medical field, it is recommended to directly use MeSH terms to specify, Medical Subject Headings(MeSH) refer to wiki <https://en.wikipedia.org/wiki/Medical_Subject_Headings>

If the gene name is used as a search term, it is recommended to put in all the aliases of the gene, which can be extracted by the following code:

```{r}
targetGene.Symbol <- HGNCdata[HGNCdata$Approved.Symbol %like% targetGene,]
targetGene.Synonyms <- HGNCdata[HGNCdata$Synonyms %like% targetGene,]
targetGeneInfo <- rbind(targetGene.Symbol, targetGene.Synonyms)
targetGeneInfo

term <- paste(as.character(targetGeneInfo$Approved.Symbol), str_replace_all(targetGeneInfo$Synonyms, ", ", " OR "), sep = " OR ")
term

# 还可以加上疾病的名字，例如GBM的MeSH term: Glioblastoma
# the name of the disease can also be added, e.g. GBM's MeSH term: Glioblastoma
#term <- paste0 ("(", term, ") AND Glioblastoma[MeSH Terms]")
#term

# 或者自己手写基因名作为检索词
# or handwrite your own gene name as a search term
#term <- "CD274 OR PD-L1 OR PDL1"
```


## 【模块一】文章的增长趋势
## [Module 1] Trends in the growth of articles
