---
title: "FigureYa169sigHeatmap"
author: "Xiaofan Lu"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirement

过配对差异表达，画亚型特异性上(下)调基因的对角热图。比如样本分了4-5个组，分析并画出每个组里面上调或下调的热图。
Draw a diagonal heatmap of subtype-specific up- and down-regulated genes based on paired differential expression. For example, if samples are divided into 4-5 groups, analyze and draw a heatmap of up- and down-regulated genes within each group.

![](example.png)

Figure 2: A) Unsupervised clustering of lncRNAs identified 4 clusters: cluster I (related to the basal-like breast cancer subtype), cluster II (related to the HER-2 enriched subtype), cluster III (related to luminal A subtype), and cluster IV (related to luminal A and B subtypes). Correlation with PAM50 classification, estrogen receptor (ER), progesterone receptor (PR) and HER2 status are depicted.

出自<https://www.ncbi.nlm.nih.gov/pubmed/25296969>
Source: <https://www.ncbi.nlm.nih.gov/pubmed/25296969>

# 应用场景
# Application Scenario

在大于等于3组亚型的基础上，得到配对差异表达基因后，计算每个亚型特异性上/下调的基因集，并绘制特异性基因表达热图。
After obtaining paired differentially expressed genes for at least three subtypes, we calculated the set of upregulated/downregulated genes for each subtype and plotted a heatmap of specific gene expression.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

```

加载包
Load the package

```{r}
library(ClassDiscovery) # 距离测量 # Distance measurement
library(edgeR) # 差异表达 # Differential expression
library(NMF) # 绘制热图 # Heatmap plotting
library(gplots) # 热图颜色 # Heatmap colors
library(RColorBrewer) # 热图颜色 # Heatmap colors

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 # Display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor # Disable conversion of chr to factors
```

自定义配对比较函数 Custom pairwise comparison function

> 这里用edgeR，如果用DESeq2或limma，就把FigureYa118MulticlassDESeq2或FigureYa119MulticlassLimma里面相应的函数替换过来，可无缝对接。
> Here, edgeR is used. If you are using DESeq2 or limma, simply replace the corresponding functions in FigureYa118MulticlassDESeq2 or FigureYa119MulticlassLimma for seamless integration.
