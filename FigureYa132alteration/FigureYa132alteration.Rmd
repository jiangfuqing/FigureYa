---
title: "FigureYa132alteration"
author: "Zongcheng Li"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 需求描述
## Requirement description

复现文章里的扫雷图。
Reproduce the minesweeper diagram in the article.

![](example.png)

出自<https://www.cell.com/cell/fulltext/S0092-8674(18)30359-3>
From <https://www.cell.com/cell/fulltext/S0092-8674(18)30359-3>

Figure 4. (B) Detailed heatmap of alteration frequencies in members of the RTK-RAS pathway. Only known or likely oncogenic alterations in each gene are considered, as described in STAR Methods. The individual gene alteration frequencies may add up to more than the total for each tumor type, as some tumor samples may have multiple alterations. Color side bars show the fraction of samples affected by each type of somatic alteration (or a combination of them) for each pathway gene. Top color bars show the proportion of different types of alterations for each cancer subtype.

**图的解析**
**Analysis of the figure**

- 横坐标按器官排列，列出了TCGA的33种癌症类型。
- 纵坐标列出作者重点关注的RTK-RAS pathway里的重要基因，其中红色为原癌基因，蓝色为抑癌基因。
- 顶部和右侧分别对应每种癌症（纵坐标）和每个基因（横坐标）里各种alteration的frequency
- The horizontal axis is arranged by organ, listing the 33 cancer types of TCGA.
- The vertical axis lists the important genes in the RTK-RAS pathway that the author focuses on, with red for proto-oncogenes and blue for tumor suppressor genes.
- The top and right sides correspond to the frequency of various alterations in each cancer (vertical axis) and each gene (horizontal axis) respectively

例文作者选取了10个重要pathway，并总结出参与这些pathway的基因共187个，保存在NIHMS957693-supplement-7.xlsx文件。提取出这些基因在TCGA 33种癌症（NIHMS957693-supplement-5.xlsx）中的alteration，总结成alteration层面、gene层面和pathway层面，保存在NIHMS957693-supplement-8.xlsx文件。
The author of the example selected 10 important pathways and summarized a total of 187 genes involved in these pathways, which are saved in the NIHMS957693-supplement-7.xlsx file. Extract the alterations of these genes in 33 types of TCGA cancer (NIHMS957693-supplement-5.xlsx), summarize them at the alteration level, gene level and pathway level, and save them in the NIHMS957693-supplement-8.xlsx file.

## 应用场景
## Application scenario

可以从作者总结的参与10个重要通路的187个基因中提取出感兴趣的基因的alteration，画你感兴趣的癌症类型里他们的突变频率图。
You can extract the alterations of the genes of interest from the 187 genes involved in 10 important pathways summarized by the author, and draw their mutation frequency charts in the cancer types you are interested in.

还可以把这个思路应用到其他基因或自己收集的突变数据上，需要先把突变数据整理成NIHMS957693-supplement-*.xlsx的格式。
This idea can also be applied to other genes or mutation data collected by yourself. You need to organize the mutation data into the format of NIHMS957693-supplement-*.xlsx.

例文多个Figure都用了这种展示方式。参考例文这些图的用法，套用在自己的数据上：
This display method is used in multiple Figures in the example text. Refer to the usage of these figures in the example text and apply them to your own data:

- 我们复现的Figure 4，RTK-RAS pathway
- Figure 5，其余9个pathway中突变频率最高的基因
- Figure S2和S3，对应Figure 5，9个pathway中所有的基因
- Figure 7，跟治疗和药物联系起来
- Figure 4 we reproduced, RTK-RAS pathway
- Figure 5, the gene with the highest mutation frequency in the remaining 9 pathways
- Figure S2 and S3, corresponding to Figure 5, all genes in the 9 pathways
- Figure 7, linked to treatment and drugs

## 环境设置
## Environment settings


```{r}
source("install_dependencies.R")

```

加载包
Load package

```{r}
library(ggplot2)
library(reshape2)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 #Display English error message
options(stringsAsFactors = FALSE) #禁止chr转成factor #Disable chr conversion to factor
```

自定义函数
Custom function
