---
title: "FigureYa73batchCorrelation"
author: "Dekang Lv, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---


# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr的全局代码块选项 / Set global chunk options for knitr
```

## 需求描述

输入TCGA的表达矩阵，按文章中的方法计算bin(或者不取bin)、批量计算一个基因跟多个基因的相关系数、pvalue，画出文章里的图

## Requirement Description

Input TCGA expression matrix, calculate bin (or not take bin), batch calculate correlation coefficient and pvalue of one gene with multiple genes according to the method in the article, and draw the graph in the article.

![](example.png)

出自<https://www.nature.com/articles/nature13473>

from<https://www.nature.com/articles/nature13473>

## 应用场景

批量筛选哪些基因跟你感兴趣的基因呈正/负相关。

不仅适用于基因表达的相关性分析，还适用于像例文那样的转录因子结合（ChIP）跟靶基因变化倍数（RNA-seq）的相关性分析。把示例中的基因信息替换成位点信息即可。

在画ChIP-seq、ATAC-seq或DNA甲基化等动辄成千上万个位点时，可以尝试这种取bin的方式画图。

## Application Scenarios

Batch screen which genes are positively/negatively correlated with your gene of interest.

Not only for gene expression correlation analysis, but also for correlation analysis of transcription factor binding (ChIP) and target gene fold change (RNA-seq) as in the example. Simply replace the gene information in the example with locus information.

When plotting thousands of loci such as ChIP-seq, ATAC-seq, or DNA methylation, you can try this binning approach.

## 环境设置

## Environment settings

```{r}
source("install_dependencies.R")


# 加载必要的R包 / Load required packages
library(reshape2)   # 数据重塑工具（如宽表转长表） / Data reshaping tools (e.g., wide to long format)
library(ggplot2)    # 高级数据可视化 / Advanced data visualization
library(cowplot)    # 提供图形排版功能 / Enhanced plot arrangement tools
library(plyr)       # 数据分割-应用-合并工具 / Tools for splitting-applying-combining data

# 设置环境语言为英文（显示英文错误信息） / Set system language to English (for English error messages)
Sys.setenv(LANGUAGE = "en")

# 防止字符串自动转换为因子 / Prevent automatic conversion of strings to factors
options(stringsAsFactors = FALSE)
```

## 参数设置

## Parameter setting
