---
title: "FigureYa64triangle"
author: "Yin Li; Ying Ge, Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 需求描述
## Requirement description

用R画出paper里的Triangle plot

Use R to draw the Triangle plot in the paper

![](example.png)

出自<https://www.cell.com/cell/fulltext/S0092-8674(18)31250-9?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS0092867418312509%3Fshowall%3Dtrue>

原文解析：

- 点的坐标代表其突变频率，越靠近三角形的一个角，代表在这个类型突变越多；
- 点的大小代表在glioma这个病中，总共的突变频率；
- 颜色代表相对突变频率

from<https://www.cell.com/cell/fulltext/S0092-8674(18)31250-9?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS0092867418312509%3Fshowall%3Dtrue>

Original analysis:

- The coordinates of the dots represent their mutation frequency, the closer to one corner of the triangle, the more mutations in this type;
- The size of the dots represents the total frequency of mutations in glioma;
- The color represents the relative mutation frequency

## 应用场景
## Application scenario

展示3种不同疾病或者3组之间某个指标的相关性，一目了然。

ggtern在文献中的应用：<http://www.ggtern.com/publications/>

带代码的更多主题：<http://www.ggtern.com/posts/>

关注“小丫画图”公众号，回复“三角形”查看ggtern在另一篇Cell paper中的用法及代码。

脑洞大开，发挥你的想象力，一定能拓展出更多应用场景。

Display the correlation of a certain indicator among 3 different diseases or 3 groups, clearly and concisely.

Application of ggtern in the literature: <http://www.ggtern.com/publications/>

More topics with codes: <http://www.ggtern.com/posts/>.

Follow “Xiaoya Drawing” official account, reply “triangle” to see the usage and code of ggtern in another Cell paper.

Use your imagination to develop more application scenarios.

## 环境设置
## Environment setting

```{r,message=FALSE}
source("install_dependencies.R")

#devtools::install_git('https://bitbucket.org/nicholasehamilton/ggtern')
#install.packages("tidyverse")
#install.packages('ggtern')
#install.packages("proto")
#install.packages("directlabels")
library(ggtern)
citation(package = 'ggtern')
library(tidyverse)
library(scales)
library(ggplot2)
library(directlabels)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor prohibit the conversion of chr to factor
```

## 输入数据预处理
## Preprocessing of input data

如果你的数据已经整理成“easy_input.csv”的格式，就可以跳过这步，直接进入“输入文件”。

下载原文的补充材料Table2.pdf，整理为"not_easy_input.csv"

If your data has been organized into “easy_input.csv” format, you can skip this step and go directly to “Input file”.

Download the original supplementary material Table2.pdf and organize it as “not_easy_input.csv”.


### 直接用原文数据画图
### Draw a graph directly using the original data

```{r}
df <- read.csv("not_easy_input.csv")
head(df)
ggtern(data=df, aes(x=df$Frequency.in.pGBM,
                    y=df$Frequency.in.LGG,
                    z=df$Frequency.in.sGBM)) +
   geom_point(size = df$Alteration.Frequency.in.glioma)
```

可以看到，点的大小和原文有较大出入，说明原文对数据进行了一定的优化。

As you can see, the dot sizes are quite different from the original article, indicating that the original article has optimized the data in some way.

### 把size扩大50倍
### Increase the size by 50 times

```{r}
ggtern(data=df,aes(x=df$Frequency.in.pGBM,y=df$Frequency.in.LGG,z=df$Frequency.in.sGBM)) +
   geom_point(size=df$Alteration.Frequency.in.glioma*50)
```

可以看到，除了几个较大的点，其他点大小同原文相似度极高，估计作者对特大值进行了不同的处理

As you can see, except for a few larger dots, the size of other dots is very similar to the original text, and it is assumed that the author handled the extremely large values differently

### 分段处理
### Segmented processing
