---
title: "FigureYa202consensusGene"
author: "Xiaofan Lu"
reviewers: "Ying Ge,Hui Huang"
date: "2025-5-20"
output: html_document
---
# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

主要是Fig.1ABC这个图。尤其是Fig.1A这种两个通路一起聚类并找到关键基因的方法，很另类。

# Requirement Description

The main thing is Fig.1ABC this figure. In particular, Fig.1A, a method of clustering two pathways together and finding key genes, is very different.

![](example.png)

出自<https://clincancerres.aacrjournals.org/content/26/1/135>
from<https://clincancerres.aacrjournals.org/content/26/1/135>

Figure 1. Stratification of PDAC tumors based on expression of glycolytic and cholesterogenic genes.
A, Heatmap depicting consensus clustering solution (k 1⁄4 3) for glycolytic and cholesterogenic genes in resected and metastatic PDAC samples (n 1⁄4 325).
B, Scatter plot showing median expression levels of coexpressed glycolytic (x-axis) and cholesterogenic (y-axis) genes in each PDAC sample. Metabolic subgroups were assigned on the basis of the relative expression levels of glycolytic and cholesterogenic genes.
C, Heatmap depicting expression levels of coexpressed glycolytic and cholesterogenic genes across each subgroup.

# 应用场景

基因共识聚类选择共表达的基因集，随后根据表达谱中位数划分四类样本。

FigureYa154immuneSubtypes和FigureYa201ClusterCorrelation也用到了ConsensusClusterPlus做共识聚类，可相互参考，灵活运用，设计出更有趣的展示方式。

# Application Scenario
Gene consensus clustering is used to select co-expressed gene sets, followed by dividing samples into four categories based on the median expression profile.

Both FigureYa154immuneSubtypes and FigureYa201ClusterCorrelation also employ ConsensusClusterPlus for consensus clustering. These examples can serve as mutual references, allowing flexible adaptation to design more innovative visualization approaches.


# 环境设置


# Environment settings


```{r}
source("install_dependencies.R")

```

加载包

```{r}
library(ConsensusClusterPlus)
library(pheatmap)
library(dendsort)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 # Display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor # Prohibit converting chr to factor
```

自定义函数用于归一化表达谱
Custom functions are used to normalize expression spectra

```{r}
standarize.fun <- function(indata=NULL, halfwidth=NULL, centerFlag=T, scaleFlag=T) {
  outdata=t(scale(t(indata), center=centerFlag, scale=scaleFlag))
  if (!is.null(halfwidth)) {
    outdata[outdata>halfwidth]=halfwidth
    outdata[outdata<(-halfwidth)]= -halfwidth
  }
  return(outdata)
}
```

# 输入文件

tcga.expr.simplified.txt，表达矩阵。

REACTOME_GLYCOLYSIS.txt和REACTOME_CHOLESTEROL_BIOSYNTHESIS.txt，参与这两个通路的基因。

# Input the file

tcga.expr.simplified.txt, the expression matrix.

REACTOME_GLYCOLYSIS.txt and REACTOME_CHOLESTEROL_BIOSYNTHESIS.txt, genes involved in these two pathways.
