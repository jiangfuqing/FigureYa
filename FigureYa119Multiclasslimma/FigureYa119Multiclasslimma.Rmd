---
title: "FigureYa119Multiclasslimma"
author: "Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr代码块的全局选项 / Set global options for knitr code chunks
```

## 需求描述

用limma实现多组差异分析。能用来替换FigureYa109SubtypeGSEA中的配对差异表达过程（亚型数目>=3），并跟它无缝对接。

## Requirement description

Implement multi group difference analysis using limma. Can be used to replace the paired differential expression process (subtype number>=3) in FigureYa109SubtypeGSEA and seamlessly integrate with it.

## 应用场景

结合FigureYa109subtypeGSEA，分析每一组与其他样品的差异基因，进而找出亚型特异富集的通路；

结合FigureYa116supervisedCluster，分析每一组与其他样品的差异基因，进而找出亚型特异的marker基因。

**注意：**本众筹不涉及批次效应消除，若样本间含有批次效应，请阅读limma相关document并修改该脚本，在设计矩阵中纳入batch effect。

**这里针对FPKM/RPKM或芯片数据作为输入的情况，如果你的数据是read count，请参考FigureYa118MulticlassDESeq2**

## Application scenarios

Based on Figure Ya109 subtype GSEA, analyze the differentially expressed genes between each group and other samples, and identify subtype specific enriched pathways;

Using FigureYa116supervisedCluster, analyze the differentially expressed genes between each group and other samples, and identify subtype specific marker genes.

**Note: * * This crowdfunding does not involve batch effect elimination. If there are batch effects between samples, please read the relevant documents of limma and modify the script to include batch effects in the design matrix.

**For the case where FPKM/RPKM or chip data is used as input, if your data is read count, please refer to FigureYa118MulticlassDESeq2**

## 环境设置


## Environment settings


```r

BiocManager::install("affy")
BiocManager::install("affyPLM")
```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载limma包 - 用于基因表达数据分析和差异表达分析
# Load the limma package - for gene expression data analysis and differential expression analysis
library(limma)

# 加载affy包 - 用于Affymetrix基因芯片数据的预处理和分析
# Load the affy package - for preprocessing and analysis of Affymetrix gene chip data
library(affy)

# 加载affyPLM包 - 提供基于探针水平模型的Affymetrix芯片数据分析方法
# Load the affyPLM package - provides probe-level model-based methods for Affymetrix chip data analysis
library(affyPLM)

# 设置环境变量使R显示英文错误信息，便于问题排查和社区求助
# Set environment variable to display English error messages for easier troubleshooting and community support
Sys.setenv(LANGUAGE = "en")

# 禁止字符串自动转换为因子类型，避免数据处理中的意外行为
# Prevent automatic conversion of strings to factors to avoid unexpected behavior in data processing
options(stringsAsFactors = FALSE)
```

自定义函数，分别比较每一组跟其他样品之间的差异，如果有更多组，按规律补充进去即可

Customize functions to compare the differences between each group and other samples separately. If there are more groups, simply add them according to the pattern
