---
title: "FigureYa17 WGCNA_heatmap"
author: "Ying Ge; Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 需求描述
## Requirement description

用R代码画出paper里WGCNA module的heatmap

Draw the heatmap of the WGCNA module in paper using R code

![](example.png)

出自<https://www.cell.com/cell/abstract/S0092-8674(18)30511-7>

from<https://www.cell.com/cell/abstract/S0092-8674(18)30511-7>

## 使用场景
## Usage scenario

WGCNA找出了gene module，展示各module的基因在各组样本中的表达谱变化。

WGCNA identified gene modules to show the changes in the expression profiles of the genes of each module in each group of samples.

## 输入数据的预处理
## Preprocessing of input data

用FigureYa15WGCNA_module输出了各个gene module内的基因表达量，每个module保存在一个csv文件中，位于当前文件夹。

WGCNA已经按照共表达特征给基因分成了多个module，因此，这里不需要再做聚类，直接按照module内基因的数量给基因排序，再用热图的方式可视化。

如果你的数据已经保存成像`easy_input.csv`的格式，就可以跳过这步，直接进入“开始画图”。

Gene expression within each gene module was output using FigureYa15WGCNA_module, and each module was saved in a csv file located in the current folder.

WGCNA has already divided genes into modules according to co-expression characteristics, so there is no need to do clustering here, and genes are directly sorted according to the number of genes within a module, and then visualized by heatmap.

If your data has been saved in a format like `easy_input.csv`, you can skip this step and go directly to "Start drawing".

```{r}
source("install_dependencies.R")
fnames<-Sys.glob("*.csv")
fnames
```

读取这些module，合并。

Read these modules, merge them.

```{r}
fdataset<-lapply(fnames,read.csv)
names(fdataset) <- fnames

library(plyr)
result <- ldply(fdataset, data.frame)
head(result)

df<-result[,2:22]
df$module<-unlist(strsplit(result$.id,split = ".csv"))
head(df)
```

按照module内基因数量从多到少，给基因排序。

Order the genes according to the number of genes within the module from most to least.
