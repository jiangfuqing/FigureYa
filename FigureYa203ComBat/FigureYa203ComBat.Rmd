---
title: "FigureYa203ComBat"
params:
  author: "Xiaofan Lu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

想众筹这篇文章里的数据处理方法，TCGA的RNA-seq数据和不同平台的microarray数据合并及标准化，希望能够得到相对统一的处理方式。

We would like to crowdfund the data processing methods described in this article, specifically the merging and normalization of TCGA RNA-seq data and microarray data from different platforms, hoping to achieve a relatively unified processing approach.

![](example.png)

跟FigureYa201ClusterCorrelation出自同一篇文章，出自：<https://www.cell.com/molecular-therapy-family/nucleic-acids/fulltext/S2162-2531(20)30259-6>

This is from the same article as FigureYa201ClusterCorrelation, originally published in: <https://www.cell.com/molecular-therapy-family/nucleic-acids/fulltext/S2162-2531(20)30259-6>

# 应用场景
# Application scenarios

不同平台的表达谱去除批次效应，绘制PCA图查看效果。

这里采用的是R包sva中的ComBat。

另外，还有一些文章采用非经典的去除批次效应的方式，例如FigureYa117multilinearDE。

Remove batch effects from expression profiles across different platforms and visualize the results using PCA plots.

Here, the ComBat method from the sva R package was used.

Additionally, some studies employ non-classical batch effect removal approaches, such as FigureYa117multilinearDE.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

```

# 加载包
# Loading packages

```{r}
library(TCGAbiolinks)
library(sva)
library(cluster)
library(oompaBase)
library(SummarizedExperiment)
library(edgeR)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

自定义函数

Custom Function
