---
title: "FigureYa217RMR"
author: "Xiaofan Lu; Ying Ge, Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirement description

基于maximum relevance minimum redundancy (mRMR)算法，采用R语言（包）实现图1。

数据：GSE84465（很有名的一个数据集，网上有些公众号都采用该数据集）

Based on the maximum relevance minimum redundancy (mRMR) algorithm, Figure 1 is implemented using the R language (package).

Data: GSE84465 (a well-known dataset, adopted by several online public accounts)

![](example.png)

出自<https://www.frontiersin.org/articles/10.3389/fbioe.2020.00167/full>

from<https://www.frontiersin.org/articles/10.3389/fbioe.2020.00167/full>

# 应用场景
# Application scenario

采用minimal Redundancy Maximal Relevance鉴定差异基因，后采用SVM + LOOCV (支持向量机 + 余一交叉验证)法，根据MCC统计量确定最小且最优基因组合用于构建预测模型。

Differential genes are identified using the minimal Redundancy Maximal Relevance method, followed by the application of SVM + LOOCV (Support Vector Machine + Leave-One-Out Cross-Validation) to determine the smallest and most optimal gene combination based on the MCC for constructing the predictive model.

# 环境设置
# Environment setting


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

install.packages("mRMRe")
```

加载包

load package

```{r}
library(mRMRe)
library(e1071)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor prohibit the conversion of chr to factor
```

自定义函数，用来显示进度

Custom function for displaying progress

```{r}
display.progress = function (index, totalN, breakN=20) {
  if ( index %% ceiling(totalN/breakN)  ==0  ) {
    cat(paste(round(index*100/totalN), "% ", sep=""))
  }
}
```

# 输入文件
# Input file

GSE84465_GBM_All_data.csv，单细胞count数据，下载自<https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84465>

cell_info.txt，单细胞样本信息，下载自<https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84465> Series Matrix File(s)

GSE84465_GBM_All_data.csv, single-cell count data, downloaded from <https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84465>

cell_info.txt, single-cell sample information, downloaded from <https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84465> Series Matrix File(s)
