---
title: "FigureYa124AssociationHeatmap"
author: "Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr代码块的全局选项 / Set global options for knitr code chunks
```

## 需求描述

将感兴趣变量和亚型（分组）之间的独立性用“热图”方式展现出来。

## Requirement description

Present the independence between the variables of interest and subtypes (groups) using a heatmap.

![](example.png)

出自<https://www.cell.com/cell/fulltext/S0092-8674(17)30815-2>

from<https://www.cell.com/cell/fulltext/S0092-8674(17)30815-2>

Figure S1. (B) Comparing tumor size, positive or negative serosal invasion, and AJCC stage between F. nucleatum high-expression and low-expression tumors of Cohort 2. The heatmap illustrates the association of different clinical characters with F. nucleatum high- and low-expression tumors. Statistical significance was performed by Chi-square test.

## 应用场景

已知分组的样本，想同时展示每个样本多个层面的特征，并标出两组间差异显著性P value。

其实个人感觉，这样的“关系”图可以作为热图的Annotation bar，绘制起来简单方便，没有必要单独画出来。不过这张图还是蛮精美的，所以我还是采用base plot来和大家玩一玩这一张“热图”。

**注意：**本人能力有限没有办法在这份代码的基础上尽可能多地考虑其他情况（输入数据类型），因此如果输入数据结构发生较大变化，代码本身需要做比较大的改动，代码的注释应该比较全面，希望大家在理解的基础上运行此代码，学习base plot的画图思路。

## Application scenarios

Given the grouped samples, we want to display multiple levels of features for each sample simultaneously and indicate the significant P value of the differences between the two groups.

In my personal opinion, such a "relationship" diagram can be used as an annotation bar for heat maps, which is simple and convenient to draw, and there is no need to draw it separately. However, this image is quite exquisite, so I will still use the base plot to play with everyone on this' heat map '.

**Attention: * * Due to my limited abilities, I am unable to consider as many other situations (input data types) as possible on the basis of this code. Therefore, if there are significant changes in the input data structure, the code itself needs to be significantly modified, and the comments on the code should be comprehensive. I hope everyone can run this code on the basis of understanding and learn the drawing ideas of base plot.

## 环境设置

## Environment settings

```{r}
source("install_dependencies.R")
# 设置系统环境语言为英文，用于显示英文报错信息
# Set system environment language to English for displaying error messages in English
Sys.setenv(LANGUAGE = "en")

# 配置选项，禁止将字符型向量自动转换为因子类型
# Configure option to disable automatic conversion of character vectors to factors
options(stringsAsFactors = FALSE)
```

## 输入文件

easy_input.txt，每行一个样本，第一列为分组（被画在图的第一行），第二列往后是其他信息（被画在图的第二行以后），用yes和no记录。

## Input file

easy_input.txt， Each row contains one sample, with the first column representing the grouping (shown in the first row of the graph) and the second column followed by other information (shown in the second row of the graph), recorded with 'yes' and' no '.
