---
title: "FigureYa60GSEA_clusterProfiler"
author: "Ying Ge ,Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 需求描述
## Requirement description

clusterProfiler的GSEA结果作为输入，画出像paper里这样美的GSEA结果图。

关注“小丫画图”公众号（微信ID：FigureYa），回复“GSEA”，查看GSEA在paper里的高级用法。

Use the GSEA results from clusterProfiler as input to draw a GSEA result plot as beautiful as those in paper.

Follow the "Xiaoya drawing" official account (WeChat ID: FigureYa), reply with "GSEA" to see advanced usage of GSEA in paper.

![](example.png)

出自<https://www.nature.com/articles/s41467-018-06944-1>

from<https://www.nature.com/articles/s41467-018-06944-1>

## 应用场景
## Application scenario

可用于在一张图上对比多个通路（上面的例图），以及同一通路多组间对比（下图）。

It can be used to compare multiple pathways on a single graph (example graph above), as well as to compare multiple groups of the same pathway (graph below).

![](https://ars.els-cdn.com/content/image/1-s2.0-S1936523318301761-gr5.jpg)

clusterProfiler擅长做富集分析，可以用GO、KEGG、Diseaes、Reactome、DAVID、MSigDB、甚至自定义的注释库做富集分析。enrichplot丰富的画图函数几乎涵盖了所有富集分析结果的展示方式，<http://bioconductor.org/packages/devel/bioc/vignettes/enrichplot/inst/doc/enrichplot.html>。

适用于：用clusterProfiler做了富集分析，想自己DIY结果图的小伙伴。

如果想用Java版GSEA做富集分析，自己DIY结果图，请用FigureYa13GSEA_Java。

clusterProfiler is good at enrichment analysis, you can use GO, KEGG, Diseaes, Reactome, DAVID, MSigDB, and even custom annotation libraries to do enrichment analysis. enrichplot's rich drawing functions cover almost all the ways of presenting enrichment analysis results, <http://bioconductor.org/packages/devel/bioc/vignettes/enrichplot/inst/doc/enrichplot.html>.

Suitable for: those who have done enrichment analysis with clusterProfiler and want to DIY the result plot by themselves.

If you want to use Java version of GSEA to do enrichment analysis and DIY result plot by yourself, please use FigureYa13GSEA_Java.

## 环境设置
## Environment setting

```{r}
source("install_dependencies.R")


#BiocManager::install("clusterProfiler", version = "3.8")

library(clusterProfiler)
library(enrichplot)
library(plyr)
library(ggrepel)
library(ggplot2)
library(RColorBrewer)
library(gridExtra)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor prohibit the conversion of chr to factor
```

## 参数设置
## Parameter setting

此处我们选择“hsa04110”这条通路，突出显示这两条通路里的几个基因。

Here we select the pathway "hsa04110" to highlight a few genes in these two pathways.
