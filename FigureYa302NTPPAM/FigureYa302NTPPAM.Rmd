---
title: "FigureYa302NTPPAM"
params:
  author: "Xiaofan Lu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

我想众筹个找出分子亚型中的特异marker并用NTP预测外部数据亚型的，分别是这两篇文章中的方法，作者是同一个人。

I want to crowdfund a project to identify specific markers in molecular subtypes and use NTP to predict the subtypes of external data, following the methods described in these two papers, which are authored by the same person.

![](method1.png)

出自：<https://www.nature.com/articles/ncomms15107>

Source: <https://www.nature.com/articles/ncomms15107>

![](method2.png)

出自：<https://www.nature.com/articles/ng.3224>

就是从表达谱数据已知样本分型情况下，找出每个亚型特异的marker，再用NTP预测亚型，其中的PAM过程不懂。

这篇文章也是差不多的方法，方法写在文章附件里：

Source: <https://www.nature.com/articles/ng.3224>

It involves identifying subtype-specific markers from expression profile data with known sample classifications, then using NTP (Nearest Template Prediction) to predict subtypes—though I don’t fully understand the PAM (Prediction Analysis of Microarrays) step.

This paper uses a similar approach, with the methods detailed in the supplementary materials:

![](method3.png)

出自：<https://www.nature.com/articles/nm.3175>

大鱼海棠的MOVICS包其实有NTP预测亚型的，但是他是直接选亚型特异表达的靠前的基因，没有用PAM这些筛选方法。这里将实现用PAM筛选。

Source: <https://www.nature.com/articles/nm.3175>

The MOVICS package from Big Fish & Begonia actually includes NTP-based subtype prediction, but it directly selects the top differentially expressed genes (DEGs) for each subtype without using filtering methods like PAM. Here, we will implement PAM-based gene selection.

# 应用场景
# Application scenarios

利用PAM算法根据某感兴趣分类筛选特异性marker，生成模版后利用NTP算法进行分类预测。

问题挺好的，用模型的方式找marker再预测，而不是直接定义前多少位高表达或低表达来构建marker。

参考资料见Literatures文件夹。

Using the PAM algorithm to screen for specific markers based on a classification of interest, then generating a template for NTP-based classification prediction.

This is a solid approach—using a model-based method to identify markers before prediction, rather than simply defining markers based on the top/bottom differentially expressed genes.

References available in the "Literatures" folder.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

BiocManager::install("pamr")
```

# 加载包
# Loading packages

```{r}
library(CMScaller)
library(pamr)
library(cluster)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files

gse17536.expr.txt - GEO结直肠癌表达谱文件。可前往百度网盘下载<https://pan.baidu.com/s/1THBHtvrR0mEgA79xcf877w?pwd=wz7w>

gse17536.expr.txt – A GEO colorectal cancer expression profile file.
Download available at <https://pan.baidu.com/s/1THBHtvrR0mEgA79xcf877w?pwd=wz7w>
