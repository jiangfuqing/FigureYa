---
title: "FigureYa113MutSigCV"
author: "Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr代码块的全局选项 / Set global options for knitr code chunks
```

# 需求描述

用MutSigCV推断SMG（significantly mutated gene），画出文章里的图。

MutSigCV是用matlab写成的，带我顺利用上它。

# Requirement description

Infer SMG (significantly mutated gene) using MutSigCV and draw the graph in the article.

MutSigCV is written in Matlab, let me use it smoothly.

![](example.png)

出自<https://www.frontiersin.org/articles/10.3389/fonc.2019.00488/full>

from<https://www.frontiersin.org/articles/10.3389/fonc.2019.00488/full>

# 应用场景

画基因突变瀑布图时，展示哪几个基因呢？可以展示显著突变基因。看例文描述：We used MutSigCV_v1.41 (20) (www.broadinstitute.org) to infer significant cancer mutated genes (q < 0.05) across the two classes currently identified with default parameters.

MutSigCV是用来推断SMG（significantly mutated gene）的，会综合考虑基因长度，以及沉默突变和非沉默突变的频率，因此如果没有沉默突变（silent mutation），或沉默突变过少（算法内有固定阈值），这个算法是无法运行的。

**注意：**若使用MutSigCV，请引用：
Lawrence MS, Stojanov P, Polak P, Kryukov GV, Cibulskis K, Sivachenko A, Carter SL, Stewart C, Mermel CH, Roberts SA (2013) Mutational heterogeneity in cancer and the search for new cancer-associated genes. Nature 499(7457): 214

如果只想直接从TCGA下载MAF文件画图，可直接使用FigureYa18oncoplot，还可以进一步用FigureYa42oncoprint自己定制瀑布图。

# Application scenarios

When drawing a waterfall diagram of gene mutations, which genes are displayed? Can display significantly mutated genes. According to the example text description: We used MutSigCV_v1.41 (20) (www.broadinstitute.org) to infer significant cancer mutated genes (q < 0.05) across the two classes currently identified with default parameters.

MutSigCV is used to infer SMG (significantly mutated genes), taking into account gene length, as well as the frequency of silent and non silent mutations. Therefore, if there are no silent mutations or too few silent mutations (with a fixed threshold within the algorithm), this algorithm cannot run.

**Note: * * If using MutSigCV, please cite:
Lawrence MS, Stojanov P, Polak P, Kryukov GV, Cibulskis K, Sivachenko A, Carter SL, Stewart C, Mermel CH, Roberts SA (2013) Mutational heterogeneity in cancer and the search for new cancer-associated genes. Nature 499(7457): 214

If you only want to download MAF files directly from TCGA for drawing, you can use FigureYa18oncoplot directly, or you can further customize waterfall plots yourself using FigureYa42oncoprint.

# 环境设置

先在R里准备MutSigCV所需的输入数据，然后用MutSigCV推断SMG，最后在R里用MutSigCV的输出文件画瀑布图。

（其实Matlab的使用方式很傻瓜，比R更容易，更像Excel）

# Environment settings

First, prepare the input data required for MutSigCV in R, then infer SMG using MutSigCV, and finally draw a waterfall plot using MutSigCV's output file in R.

(Actually, the way Matlab is used is quite simple, easier than R, and more like Excel)

## 安装MutSigCV

第一步：安装Matlab。目前MutSigCV的源码是用Matlab编写的，可前往Matlab网站注册，下载30天试用版：<https://ww2.mathworks.cn/campaigns/products/trials.highResolutionDisplay.html?prodcode=ML>。

第二步：把`MutSigCV.m`文件拷贝到当前文件夹就可以使用了。

## Install MutSigCV

Step 1: Install Matlab. At present, the source code of MutSigCV is written in Matlab. You can register on the Matlab website and download the 30 day trial version:< https://ww2.mathworks.cn/campaigns/products/trials.highResolutionDisplay.html?prodcode=ML >.

Step 2: Copy the 'MutSigCV. m' file to the current folder to use.

## 安装并加载画图所需的R包

## Install and load the R package required for drawing

```{r}
source("install_dependencies.R")


# 加载R包 | Load R packages
library(tidyverse)      # 数据处理和可视化工具集 | Data processing and visualization toolkit
library(magrittr)       # 提供管道操作符 %>% | Provides pipe operator %>%
library(readxl)         # 读取Excel文件 | Read Excel files
library(stringr)        # 字符串处理工具 | String processing tools
library(forcats)        # 因子处理工具 | Factor processing tools
library(ComplexHeatmap) # 复杂热图绘制 | Complex heatmap plotting
library(RColorBrewer)   # 颜色方案 | Color schemes
Sys.setenv(LANGUAGE = "en") # 显示英文报错信息 | Display error messages in English
options(stringsAsFactors = FALSE) # 禁止chr转成factor | Prevent converting strings to factors
```

# 输入文件

easy_input_meta.local mutation.full.txt，MAF文件，用于推断SVG。从TCGA下载MAF文件的方法可参考FigureYa19Lollipop。

meta.mut.rda和local.mut.rda，用于画图时展示两组，非必需。里面分别保存了两组样品名称（字符串）。此处只是为了重现原图，实际使用时请选用自己不同亚型的样本。

另外，在后面的“使用MutSigCV推断SMG”的“参数设置”部分需要下载默认文件。

# Input file

Easyinput_ceta.local mutation.full.txt, MAF file, used for inferring SVG. The method of downloading MAF files from TCGA can refer to FigureYa19Lollipop.

Meta.mut.rda and local.mut.rda are used to display two sets during drawing and are not mandatory. There are two sets of sample names (strings) saved inside. This is only for reproducing the original image. Please choose your own samples of different subtypes for actual use.

In addition, the default file needs to be downloaded in the "Parameter Settings" section of "Inferring SMG using MutSigCV" later on.
