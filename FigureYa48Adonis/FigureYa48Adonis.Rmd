---
title: "FigureYa48 Adonis"
author: "yeoli; Ying Ge, Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 需求描述
## Requirement description

进行置换多元方差分析（PERMANOVA，Adonis），画出图b

Perform permutational multivariate analysis of variance (PERMANOVA, Adonis) and draw Figure b.

![](https://media.springernature.com/lw900/springer-static/image/art%3A10.1038%2Fs41591-018-0164-x/MediaObjects/41591_2018_164_Fig1_HTML.png)

图 1：取样区域和肠道微生物群区域差异概览。
b，条形图说明了与肠道微生物变化显著相关的前 30 个宿主因素。这些变化来自样本间加权的 UniFrac 距离。条形图根据元数据类别着色。规模效应和统计显著性由 PERMANOVA (Adonis) 计算。FDR控制在5%。DBP：舒张压；TCHO：总胆固醇；FBG：空腹血糖。

出自<https://www.nature.com/articles/s41591-018-0164-x>

Fig. 1: Overview of sampling regions and of regional variation in gut microbiota.
b, Bar plot illustrating the top 30 host factors found to be significantly associated with gut microbial variations. The variations were derived from between-sample weighted UniFrac distances. The bars are colored according to metadata categories. Size effect and statistical significance were calculated by PERMANOVA (Adonis). FDR was controlled at 5%. DBP, diastolic blood pressure; TCHO, total cholesterol; FBG, fasting blood glucose.

from<https://www.nature.com/articles/s41591-018-0164-x>

## 应用场景
## Application scenario

分析不同分组或环境因子对样品差异的解释度，例如例文中宿主的临床表型对肠道微生物的影响。

Analyze the explanatory power of different groups or environmental factors on sample differences, such as the impact of the host's clinical phenotype on gut microbiota in the example text.

## 输入数据
## Input data

三个输入文件：

Three input files:

```{r}
source("install_dependencies.R")
#肠道微生物数据，每行为一种肠道微生物，每一列为一个样本
#gut microbiota data, each row represents a type of gut microbe, and each column represents a sample
mydata <- read.table("easy_input_meta.txt",head=T,sep = "\t",row.names = 1)
mydata <- t(mydata) #转置
mydata[1:3,1:4]

#理化因子表格，每行为一个样本，每一列为一个因子，例如年龄、疾病、吸烟等
#physicochemical factor table, one sample per row, one factor per column, e.g., age, disease, smoking, etc.
myfactor <- read.table("easy_input_factors.txt",header = T,sep = "\t", row.names = 1)
head(myfactor)

#非必需，理化因子的分组信息，例如某几个因子都属于生活方式
#non-essential, grouping information of physicochemical factors, for example, certain factors all belong to lifestyle
gp <- read.table("easy_input_factor.group.txt",head=F,sep = "\t")
colnames(gp) <- c("factor","group")
head(gp)
```

## 开始计算
## Start calculating
