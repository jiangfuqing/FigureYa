---
title: "FigureYa151pathifier"
author: "Xiaofan Lu"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirement

使用R package "pathifier"，根据样本基因表达水平，计算指定基因通路得分，并绘制热图。
Use the R package "pathifier" to calculate the pathway score of a specified gene based on the gene expression levels of the sample and draw a heatmap.

![](example.png)

出自<https://www.thno.org/v08p6386.htm>
From <https://www.thno.org/v08p6386.htm>

Figure 4. Identification of “non-luminal-like” subgroup from ER+PR-HER2- breast cancer. (B) Enriched pathways in the Kyoto Encyclopedia of Genes and Genomes (KEGG) collection of the non-luminal-like subgroup compared to the luminal-like subgroup of the TCGA cohort by **Pathifier algorithm**. Heatmap showing the pathway scores of each ER+PR-HER2- tumor.

The non-luminal-like subtype in the ER+PR-HER2- group presented **higher Pathifier [29] scores in** biosynthesis, metabolism and DNA replication (Figure 4B) and lower endocrine sensitivity scores (P<0.05, Figure 4C and Figure S7A).

# 应用场景
# Application Scenarios

用差异基因列表做富集分析，或做GSEA，有时会因为参数设置原因而看不到自己感兴趣的通路，这时可以把基因的表达矩阵转换为通路的表达矩阵，就可以直接观察自己感兴趣的通路的表达矩阵了。
When performing enrichment analysis or GSEA using a differentially expressed gene list, pathways of interest may not be visible due to parameter settings. In such cases, converting the gene expression matrix to a pathway expression matrix allows direct visualization of the pathway of interest.

另外，R包GSVA也能够实现类似的功能，用法可参考FigureYa61GSVA。
Alternatively, the R package GSVA can also perform similar functions. For usage, see FigureYa61GSVA.

# 环境设置
# Environment Setup

Using a Chinese mirror to install the package

```{r}
source("install_dependencies.R")
```

```{r, eval=FALSE}

BiocManager::install("pathifier")
```

加载包
Loading the package

```{r}
library(pathifier)
library(data.table)
library(pheatmap)
library(gplots)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 #Display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor #Disable conversion of chr to factor
```

自定义函数（来自cogena）
Custom function (from cogena)
