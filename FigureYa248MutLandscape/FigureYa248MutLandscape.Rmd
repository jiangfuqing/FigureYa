---
title: "FigureYa248MutLandscape"
author: "Xiaofan Lu"
reviewers: "Ying Ge, Hui Huang"
date: "2025-9-12"
output: html_document
---
# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

大鱼海棠写的MOVICS包很神奇，一个包几乎就画出了分子分型文章的大部分图。大鱼海棠写的这篇预印本最近已接收，刚好可以作为MOVICS包的应用案例。接下来会连续众筹这篇文章里的几个图。

Figure2b的突变综合性热图，看起来非常酷炫。里头涉及的分析在以前的众筹里也有，包括TMB计算，突变signature，突变频数，拷贝数变异情况等等。如果大鱼老师可以随便拟定数据画图也可以！

# Requirement Description

The MOVICS package I wrote was amazing, and a single package almost drew most of the diagram of the molecular typing article. This preprint I wrote was recently received and could be used as an example of the use case for the MOVICS package. Next, we will continue to crowdfund several pictures in this article.

Figure2b's comprehensive heatmap of mutations looks really cool. The analysis involved in it is also available in previous crowdfunding, including TMB calculation, mutation signature, mutation frequency, copy number variation, and so on.

![](example.png)

出自<https://www.biorxiv.org/content/10.1101/2021.05.30.446369v1.full>
from<https://www.biorxiv.org/content/10.1101/2021.05.30.446369v1.full>

Figure 2. Molecular landscape of four MIBC iCSs.
b) Genomic alteration landscape according to iCS. Samples are ordered by the combined contribution of APOBEC-related mutational signatures (SBS2 + SBS13) with each iCS. Tumour mutation burden (TMB), relative contribution of four mutational signatures, selected differentially mutated genes (>5%) and broad-level copy number alterations (>20%), and selected genes located within chromosome 9p21.3 are shown from the top to the bottom panels. The proportion of iCS in each alteration is presented in the right bar charts.

# 应用场景

这里用complexheatmap绘制mutation landscape，图中同时展示了各亚型的突变01矩阵、突变频数、突变signature、拷贝数。这种组合热图也可以用于其他类型数据的合并展示。

- 突变频数TMB可参考FigureYa51TMB的mutation-load.txt，TCGA的TMB，来源于2018年的这篇文献：The Immune Landscape of Cancer <https://pubmed.ncbi.nlm.nih.gov/29628290/>，我们直接拿来用就好。
- 突变签名可参考FigureYa110mutationSignature。
- 更多分析、展示突变、拷贝数的FigureYa看这里<https://k.koudai.com/gZBI0YzR>

文中很多图我们都众筹过，例如：

- Figure 1b的画法可参考FigureYa196PanPie
- Figure 3de可产考FigureYa25sankey和FigureYa125Fishertest
- Figure 4f可参考FigureYa106immunotherapy，4h可参考<https://k.koudai.com/Eig1YOB4>
- Figure 5b可参考FigureYa12box，f可参考FigureYa162boxViolin
- Figure 6可参考FigureYa35batch_bestSeparation，FigureYa144DiagHeatmap或<https://mp.weixin.qq.com/s/34WRZRBVPHUNRLlzNH2nzw>

# Application Scenarios

Here, the mutation landscape is plotted with ComplexHeatMap, which shows the mutation 01 matrix, mutation frequency, mutation signature, and copy number of each subtype at the same time. This combined heatmap can also be used for the combined display of other types of data.

- For the mutation frequency TMB, please refer to the mutation-load.txt of FigureYa51TMB, the TMB of TCGA, from this 2018 article: The Immune Landscape of Cancer <https://pubmed.ncbi.nlm.nih.gov/29628290/>, let's just use it.
- For more information about mutation signatures, see FigureYa110mutationSignature.
- For more analysis and display of mutations and copy numbers of FigureYa see here <https://k.koudai.com/gZBI0YzR>

Many of the pictures in the article have been crowdfunded, such as:

- For more information about Figure 1b, see FigureYa196PanPie
- Figure 3de can be tested with FigureYa25sankey and FigureYa125Fishertest
- Figure 4f can refer to Figure Ya106 immunotherapy, and 4h can refer to <https://k.koudai.com/Eig1YOB4>
- Figure 5b can refer to FigureYa12box, and f can refer to FigureYa162boxViolin
- For Figure 6, see FigureYa35batch_bestSeparation, FigureYa144DiagHeatmap, or <https://mp.weixin.qq.com/s/34WRZRBVPHUNRLlzNH2nzw>

# 环境设置

# Environment settings

```{r}
source("install_dependencies.R")
```

加载包
load packages

```{r}
library(ComplexHeatmap)
library(RColorBrewer)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 # error messages are displayed in English
options(stringsAsFactors = FALSE) #禁止chr转成factor  #chr is not allowed to be converted to factor
```

# 输入文件
# Input files
