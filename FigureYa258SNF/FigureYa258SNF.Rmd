---
title: "FigureYa258SNF"
params:
  author: "Xiaofan Lu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

用多组学数据，比如DNA甲基化和基因表达数据，一起识别疾病亚组，像这篇文章用相似网络融合 (SNF)这种方法。

Using multi-omics data, such as DNA methylation and gene expression data, to jointly identify disease subgroups, as demonstrated in this article using methods like Similarity Network Fusion (SNF).

![](method.png)

出自：<https://www.sciencedirect.com/science/article/pii/S1535610817302015?via%3Dihub>

Source: <https://www.sciencedirect.com/science/article/pii/S1535610817302015?via%3Dihub>

# 应用场景
# Application scenarios

使用相似性网络融合算法（Similarity network fusion, SNF）对多组学数据进行联合聚类。

FigureYa69cancerSubtype用到了SNFCC方法，是对同一个数据集的聚类，这次是对多组学数据聚类。

Using the Similarity Network Fusion (SNF) algorithm for joint clustering of multi-omics data.

FigureYa69cancerSubtype employed the SNFCC method for clustering the same dataset, whereas this time, it is applied to multi-omics data clustering.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

install.packages("SNFtool")
BiocManager::install("wateRmelon")
```

# 加载包
# Loading packages

```{r}
library(SNFtool)
library(data.table)
library(pheatmap)

# 自定义函数
# Custom function
normalize <- function(X) X/rowSums(X)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files

文件较大，已上传微云 <https://share.weiyun.com/9BYhu2QF>

easy_input_expr.txt: 表达谱矩阵。

easy_input_beta.txt: 甲基化数据，beta值。

The file is large and has been uploaded to Weiyun <https://share.weiyun.com/9BYhu2QF>

easy_input_expr.txt: Expression profile matrix.

easy_input_beta.txt: Methylation data (beta values).
