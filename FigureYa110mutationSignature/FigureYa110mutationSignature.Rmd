---
title: "FigureYa110mutationSignature"
author: "Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 使用knitr包设置全局代码块选项
# Set global chunk options using knitr package
```

## 需求描述

画出文章里的3个热图：

## Requirement description

Draw three heat maps from the article:

![](example.png)

出自<https://academic.oup.com/annonc/article/28/7/1597/3611460>

from<https://academic.oup.com/annonc/article/28/7/1597/3611460>

## 应用场景

利用deconstructsigs计算突变签名模式，NMF做聚类分析，寻找亚型驱动签名，并绘制热图。

**注意：若使用本众筹分析流程，请引用：**

Alexandrov LB, Nik-Zainal S, Wedge DC, Aparicio SA, Behjati S, Biankin AV, et al. Signatures of mutational processes in human cancer. Nature 2013;500(7463):415.

Rosenthal R, McGranahan N, Herrero J, Taylor BS, Swanton C. DeconstructSigs: delineating mutational processes in single tumors distinguishes DNA repair deficiencies and patterns of carcinoma evolution. Genome biology 2016;17(1):31.

Gaujoux R , Seoighe C . A flexible R package for nonnegative matrix factorization[J]. BMC Bioinformatics, 2010, 11(1):367.

## Application scenarios

Using decortructsigs to calculate mutation signature patterns, NMF performs clustering analysis to find subtype driven signatures, and draws a heatmap.

**Attention: If using this crowdfunding analysis process, please cite:**

Alexandrov LB, Nik-Zainal S, Wedge DC, Aparicio SA, Behjati S, Biankin AV, et al. Signatures of mutational processes in human cancer. Nature 2013; 500(7463):415.

Rosenthal R, McGranahan N, Herrero J, Taylor BS, Swanton C. DeconstructSigs: delineating mutational processes in single tumors distinguishes DNA repair deficiencies and patterns of carcinoma evolution. Genome biology 2016; 17(1):31.

Gaujoux R , Seoighe C . A flexible R package for nonnegative matrix factorization[J]. BMC Bioinformatics, 2010, 11(1):367.

## 环境设置


## Environment settings


```r

BiocManager::install("BSgenome")
BiocManager::install("BSgenome.Hsapiens.UCSC.hg19")
BiocManager::install("GenomeInfoDb")
```

deconstructsigs的安装：从github下载<https://github.com/raerose01/deconstructSigs>，解压缩，然后压缩为.tar.gz格式，本地安装。

Installation of decorstructsigs: Download from GitHub< https://github.com/raerose01/deconstructSigs >Extract and compress to. tar.gz format for local installation.

```bash
tar -czvf deconstructSigs.tar.gz deconstructSigs-master
```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载数据分析常用工具包
# Load commonly used data analysis toolkits
library(tidyverse)
# 管道操作符包
# Pipe operator package
library(magrittr)
# Excel文件读取包
# Excel file reading package
library(readxl)
# 字符串处理包
# String processing package
library(stringr)
# 因子处理包
# Factor processing package
library(forcats)
# 突变特征分析包
# Mutation signature analysis package
library(deconstructSigs)
# 人类基因组参考包（hg19）
# Human genome reference package (hg19)
library(BSgenome.Hsapiens.UCSC.hg19)
# 非负矩阵分解包
# Non-negative matrix factorization package
library(NMF)

# 设置环境变量使R显示英文错误信息
# Set environment variable to display R error messages in English
Sys.setenv(LANGUAGE = "en")
# 禁止将字符串自动转换为因子类型
# Disable automatic conversion of strings to factors
options(stringsAsFactors = FALSE)
```

## 输入文件

blca.mut.maf.txt，基因突变数据。

## Input file

blca.mut.maf.txt， Genetic mutation data.
