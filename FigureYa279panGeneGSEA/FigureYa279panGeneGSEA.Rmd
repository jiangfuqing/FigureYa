---
title: "FigureYa279panGeneGSEA"
params:
  author: "Xiaofan Lu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

想把FigureYa253panGSEA<https://k.youshop10.com/QbM6nwGB>中的单基因多通路的泛癌富集分析改成"多基因，单通路的泛癌富集分析"，即把下图中的Y轴变成了基因，X轴还是癌种。

I want to modify the pan-cancer enrichment analysis in FigureYa253panGSEA<https://k.youshop10.com/QbM6nwGB> from "single-gene multi-pathway" to "multi-gene single-pathway" analysis. That is, changing the Y-axis in the figure to show genes while keeping the X-axis as cancer types.

![](example.png)

出自：<https://www.cell.com/iscience/fulltext/S2589-0042(20)30489-2?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS2589004220304892%3Fshowall%3Dtrue>

图3. 铁死亡与信号通路及免疫表型的关系。
(A和B) 高FPI与低FPI肿瘤组织间代谢通路(A)和癌症信号(B)的富集分析。NES表示GSEA算法中的标准化富集分数。

Source: <https://www.cell.com/iscience/fulltext/S2589-0042(20)30489-2?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS2589004220304892%3Fshowall%3Dtrue>

Figure 3. Relationships between Ferroptosis and Signaling Pathways and Immunophenotypes.
(A and B) Enrichment analysis for metabolism pathway (A) and cancer signaling (B) between high- and low-FPI tumor tissues. NES is the normalized enrichment score in the GSEA algorithm.

# 应用场景
# Application scenarios

基于特定基因两组数据，对每个肿瘤进行单基因集富集分析(GSEA)，展示某特定通路的富集情况。

更多pancancer分析画图FigureYa看这里<https://k.youshop10.com/C8RkTgR3>

Based on two groups of specific gene data, single gene set enrichment analysis (GSEA) was performed for each tumor to demonstrate the enrichment of a particular pathway.

For more pan-cancer analysis and visualization (FigureYa), check here<https://k.youshop10.com/C8RkTgR3>

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

```

# 加载包
# Loading packages

```{r}
library(clusterProfiler)
library(limma)
library(ggplot2)
library(data.table)
library(ggpubr)
library(SimDesign)
source("twoclasslimma.R")

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files

merged_sample_quality_annotations.tsv，样本分组信息。下载自<http://api.gdc.cancer.gov/data/1a7d7be8-675d-4e60-a105-19d4121bdebf>。

EBPlusPlusAdjustPANCAN_IlluminaHiSeq_RNASeqV2.geneExp.tsv，表达矩阵，第一列是基因，之后是其在每个样本中的表达量。下载自<http://api.gdc.cancer.gov/data/3586c0da-64d0-4b74-a449-5ff4d9136611>。

merged_sample_quality_annotations.tsv, sample grouping information. Downloaded from <http://api.gdc.cancer.gov/data/1a7d7be8-675d-4e60-a105-19d4121bdebf>.

EBPlusPlusAdjustPANCAN_IlluminaHiSeq_RNASeqV2.geneExp.tsv, expression matrix where the first column lists genes, followed by their expression levels in each sample. Downloaded from <http://api.gdc.cancer.gov/data/3586c0da-64d0-4b74-a449-5ff4d9136611>.
