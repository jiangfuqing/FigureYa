---
title: "FigureYa69 CancerSubtypes"
author: "Jingze Gao, Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr代码块的全局选项 / Set global options for knitr code chunks
```

## 需求描述

输入TCGA数据，复现原图。

## Requirement Description

Input TCGA data to reproduce the original image.

![](example.png)

出自<https://link.springer.com/article/10.1007%2Fs00432-018-2684-7>

from<https://link.springer.com/article/10.1007%2Fs00432-018-2684-7>

## 应用场景

Consensus Clustering for cancer subtype identification，使用SNFCC +与HC和NMF算法进行分子分型，并进行比较。

CancerSubtypes包含5种计算方法对基因组数据进行癌症分子分型鉴定：

1.CC 2.CNMF 3.iCluster 4.SNF 5.WSNF

## Application Scenarios

Consensus Clustering for cancer subtype identification using SNFCC + with HC and NMF algorithms for molecular typing and comparison.

CancerSubtypes contains 5 computational methods for molecular typing identification of cancer on genomic data:

1.CC 2.CNMF 3.iCluster 4.SNF 5.WSNF

## 环境设置


## Environment settings


```r

if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
install.packages("iCluster_2.1.0.tar.gz", repos = NULL, type = "source")
BiocManager::install("CancerSubtypes", version = "3.20")

```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载stringr包 - 用于字符串处理和操作
# Load the stringr package - used for string processing and manipulation
library(stringr)

# 加载CancerSubtypes包 - 用于癌症亚型分析和分类
# Load the CancerSubtypes package - used for cancer subtype analysis and classification
library(CancerSubtypes)
```

## 输入数据预处理

> 申明：

- 聚类本身有随机性，对数据的呈现形式没有严格要求。当数据形式变化时（或聚类方式变化时）聚类结果即出现差异，因此要得到有生物学意义的聚类结果需要对聚类数据乃至方法反复调试，包括数据标准化类型（如FPKM、 TPM、RSEM）、特征筛选过程（取高变异、生存相关等等）、距离度量方式、聚类方法等。

- 本代码不涉及具体某种类型的数据获取和统一的预处理方式。

- 此外，非负矩阵分解NMF非常耗时，因此使用的数据仅包括筛选过的少量mRNA和miRNA。

### 数据下载

TCGA数据的多种下载渠道：

- 所有的数据（组学和临床病理学）都可以通过TCGAbiolink下载获得，包括临床信息，参考FigureYa18（临床和突变），FigureYa22、23或34（表达数据read count、FPKM，或转换为TPM）

- 或者在xena下载你感兴趣的癌症的，除生存信息以外的所有组学数据，下载地址：<https://xenabrowser.net/datapages/?hub=https://tcga.xenahubs.net:443>

- 或者在xena下载处理好批次效应的TCGA和GTEx的pan-cancer数据，可参考FigureYa56immune_inflitration，下载Cell处理优化过的生存资料并跟RNA-seq数据对应，参考FigureYa66单因素cox。作者小高提供的下载和预处理代码见How to get easy input from xena pan-cancer file.Rmd。

- 临床病理学和生存信息还可以在firehose上下载，下载地址：<http://gdac.broadinstitute.org/>

- 数据也可以在cbioportal上下载，包括组学数据和临床病理学信息，下载地址：<http://www.cbioportal.org/datasets>

## Input data preprocessing

> Affirmation:

- Clustering itself has randomness and does not have strict requirements on the form of data presentation. When the form of data changes (or when the clustering method changes), the clustering results will be different, therefore, to obtain biologically meaningful clustering results, we need to repeatedly debug the clustering data and even the method, including the type of data standardization (e.g., FPKM, TPM, RSEM), the process of feature filtering (high variance, survival correlation, etc.), the distance measure, clustering method, etc. This code does not involve the acquisition of a specific type of data and unified preprocessing methods.

- This code does not deal with a specific type of data acquisition and unified preprocessing methods.

- In addition, non-negative matrix factorization of NMF is very time-consuming, so the data used only includes a small amount of screened mRNAs and miRNAs.

### Data download

Multiple download channels for TCGA data:

- All data (histology and clinicopathology) are available via TCGAbiolink downloads, including clinical information, refer to FigureYa18 (clinical and mutation), FigureYa22, 23 or 34 (expression data read count, FPKM, or converted to TPM).

- Or download all histologic data for your cancer of interest, except survival information, from xena at <https://xenabrowser.net/datapages/?hub=https://tcga.xenahubs.net:443>.

- Or download the pan-cancer data with TCGA and GTEx processed for batch effects at xena, see FigureYa56immune_inflitration, download Cell processed and optimized survival information and correspond to RNA-seq data, see FigureYa66 single factor cox. provided by the author, Siu Ko. Download and preprocessing code is available at How to get easy input from xena pan-cancer file.Rmd.

- Clinicopathologic and survival information can also be downloaded from firehose at <http://gdac.broadinstitute.org/>

- Data can also be downloaded on cbioportal, including histologic data and clinicopathologic information, at <http://www.cbioportal.org/datasets>

### 数据格式要求

所有组学数据保持样本一致且顺序一致即可。

- 输入：列为样本，行为观测

- 临床生存信息必须和组学数据样本顺序完全一致，基于生存分析的变量筛选以及KM曲线绘制，CancerSubtypes仅利用生存时间和生存状态两个变量，因此请提前检查样本是否匹配！

### Data format requirements

It is sufficient to keep all histologic data in the same sample and in the same order.

- Inputs: listed as samples, behavioral observations

- Clinical survival information must be in the exact same order as the sample of the histology data. Based on the variable screening for survival analysis and the KM curve plotting, CancerSubtypes only utilizes two variables, survival time and survival status, so please check in advance if the samples match!

### 读取mRNA表达数据和miRNA表达数据

### Read mRNA expression data and miRNA expression data
