---
title: "FigureYa198SignatureCombinationV2"
author: "Xiaofan Lu"
reviewers: "Ying Ge,Hui Huang"
date: "2025-5-20"
output: html_document
---
# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

我想众筹下文章figure 1c的计算方法，FigureYa182RFSurv挑出了importance 比较大的基因，后续常规用muticox等方法再缩减基因。这篇文章写的是用1023中组合按KM的 logRank pvalue和基因数目挑选模型，不一样的风格。

# Requirement Description
I would like to crowdsource the calculation method for Figure 1c in the article. FigureYa182RFSurv selected genes with relatively high importance, followed by conventional methods like multicox to further reduce the number of genes. However, this paper describes a different approach—selecting the model from 1,023 combinations based on the log-rank p-value of the Kaplan-Meier (KM) analysis and the number of genes, which is a distinct style.


![](example.png)

出自<https://onlinelibrary.wiley.com/doi/abs/10.1002/jcp.28600>
from<https://onlinelibrary.wiley.com/doi/abs/10.1002/jcp.28600>

FIGURE 1 Identification of candidate genes and development of an integrated PCG‐lncRNA signature. (a) Volcano plot displayed the lncRNAs and PCGs of the univariate Cox regression analysis. (b) Random survival forest analysis screened 10 genes. (c) After Kaplan–Meier analysis of 2 ‒1 = 1,023 combinations, the top 20 signatures were sorted according to the p value of KM. And the signature included five genes that were screened out, for it had a relative big −log10 p value and a small number of genes. KM: Kaplan–Meier; lncRNA: long noncoding RNA; PCG: protein‐coding gene

# 应用场景
# Application scenarios

核心就是排列组合。

根据随机生存森林分析筛选变量，通过基因组合后利用log-rank检验取p值显著且基因个数较少的组合，定义为预后签名。

The core idea is permutation and combination.

Based on the variables screened by random survival forest analysis, gene combinations are evaluated using the log-rank test, and the combination with a significant p-value and a smaller number of genes is selected as the prognostic signature.

# 环境设置
# Environment settings


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

install.packages("randomForestSRC")
```

加载包
load package

```{r}
library(survival)
library(randomForestSRC)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 # error messages are displayed in English
options(stringsAsFactors = FALSE) #禁止chr转成factor # It is forbidden to convert chr into factor
```

自定义函数
Custom functions
