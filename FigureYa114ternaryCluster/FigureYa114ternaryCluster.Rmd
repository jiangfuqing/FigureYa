---
title: "FigureYa114ternaryCluster"
author: "Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr代码块的全局选项 / Set global options for knitr code chunks
```

## 需求描述

仅对某感兴趣通路做聚类分析，同时纳入正常样本表达水平的考虑，来挖掘癌症样本异质性。大神丢的文章能解决我的问题，想众筹下面这个图

## Requirement description

Perform cluster analysis only on a specific pathway of interest, while considering the expression level of normal samples, to explore cancer sample heterogeneity. The article lost by the great god can solve my problem. I would like to crowdfund the following image

![](example.png)

出自<https://www.gastrojournal.org/article/S0016-5085(17)36144-9/abstract>

from<https://www.gastrojournal.org/article/S0016-5085(17)36144-9/abstract>

## 应用场景

在一组样本中某个geneset表达谱变异很大时，展示这个geneset的所有基因表达异质性。

同时还能根据这个geneset的基因表达谱对样本进行分组。分组结果可尝试用于解释样本的另一个性状或临床指标（如预后）的差异，最终证明该geneset与样本性状或临床指标的关联。

## Application scenarios

When there is significant variation in the expression profile of a certain gene set in a set of samples, display all gene expression heterogeneity of this gene set.

At the same time, samples can be grouped based on the gene expression profile of this geneset. The grouping results can be attempted to explain the differences in another trait or clinical indicator (such as prognosis) of the sample, ultimately proving the association between the geneset and the sample trait or clinical indicator.

## 环境设置

## Environment settings

```{r warning=FALSE}
source("install_dependencies.R")

# Install and load packages
Packages <- c("pheatmap","gplots") # CRAN的包 | Packages from CRAN
for(pk in Packages){
  # 检查包是否已安装，未安装则安装
  # Check if the package is installed, install if not
  if(!require(pk,character.only = T,quietly = T)) install.packages(pk)
  # 加载包并抑制加载信息
  # Load the package and suppress loading messages
  suppressMessages(library(pk,character.only = T))
}

# 安装并加载Bioconductor源的GSVA包
# Install and load GSVA package from Bioconductor
if(!require("GSVA",character.only = T,quietly = T)){
  if(!require("BiocManager",character.only = T, quietly = TRUE)) install.packages("BiocManager")
  BiocManager::install("GSVA") # Bioconductor的包 | Package from Bioconductor
}
suppressMessages(library("GSVA",character.only = T))

# 设置英文报错信息
# Set error messages to English
Sys.setenv(LANGUAGE = "en")

# 禁止chr自动转换为factor
# Disable automatic conversion of character to factor
options(stringsAsFactors = FALSE)
```

## 参数设置

## Parameter settings
