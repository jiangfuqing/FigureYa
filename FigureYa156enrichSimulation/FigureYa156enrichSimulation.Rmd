---
title: "FigureYa156enrichSimulation"
author: "Zongcheng Li"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirement

作者前面找到两个cohort共有的58个差异表达RBPs，其中21个过表达跟预后差有关。
那么，这21个RBPs是不是随机也能出现？有统计学意义吗？
The authors previously identified 58 differentially expressed RBPs shared by two cohorts, 21 of which were overexpressed and associated with poor prognosis.
Could these 21 RBPs have appeared randomly? Are they statistically significant?

重复文章中的这段方法，提供一个统计学上的结果，支持说他选择的基因集有生物学意义。
Repeat the method in the article and provide statistical results to support the biological significance of the gene set they selected.

![](method.png)

出自<https://link.springer.com/article/10.1186%2Fs13059-016-0990-4>
From <https://link.springer.com/article/10.1186%2Fs13059-016-0990-4>

# 应用场景
# Application Scenario

通过（蒙特卡洛）随机模拟计算观测事件发生的经验性概率。
Calculate the empirical probability of an observed event through (Monte Carlo) random simulation.

该方法可以从统计学角度帮助判断观测事件是否为小概率事件。
This method can help determine whether an observed event is a low-probability event from a statistical perspective.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

if(!require('cgdsr')) install.packages("cgdsr") # cdgsr package @ http://www.cbioportal.org/rmatlab
```

加载包
Load the package

```{r}
library(cgdsr)
Sys.setenv(LANGUAGE = "en") #显示英文报错信息 # Display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor # Disable conversion of chr to factor
```

# 输入文件
# Input File

## Get RBP genes

get rbp gene list from `Gerstberger S, Hafner M, Tuschl T. A census of human RNA-binding proteins. Nat Rev Genet. 2014;15:829–45.` <https://www.nature.com/articles/nrg3813/#supplementary-information>

```{r rbp_list}
rbplist <- readxl::read_excel(path = "nrg3813-s3.xls", sheet = 2)
```

## Use CGDS-R to get Genetic Data (mutation and CNA)

原文用CGDS-R包从cBioPortal下载数据，我们重复原文，体验一下CGDS-R包的用法。
The original article used the CGDS-R package to download data from cBioPortal. We will repeat the original article to experience the use of the CGDS-R package.
