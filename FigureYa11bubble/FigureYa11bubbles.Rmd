---
title: "FigureYa11bubbles"
author: "Ying Ge; Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirement description

用R代码画出paper里的基因功能富集分析泡泡图，按对角线排列很好看

热图用代码9解决，本代码解决泡泡图

Use R code to draw the gene function enrichment analysis bubble map from the paper, it looks good arranged diagonally

Heat maps are solved with code 9, this code solves bubble maps

![](example.png)

# 使用场景
# Usage scenario

场景一：展示基因功能富集分析的结果

场景二：多维度的数据信息展示

Scenario 1: Present the results of gene function enrichment analysis

Scenario 2: Multi-dimensional data information display

# 环境设置
# Environment setting


```{r}
source("install_dependencies.R")

```

加载包

load package

```{r}
library(ggplot2)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor prohibit the conversion of chr to factor
```

# 输入数据
# Input data

例文左半部分是下调表达的基因，右侧是上调表达的基因。

我们这里都用easy_input.txt文件，实际应用时，替换成你的富集分析结果即可。

至少包括：Term、Pvalue、number of genes in group(test, Pop.Hits)，number of annotated gene(background, Count)或者Gene Ratio(test/background)

The left half of the example shows down-regulated genes, while the right side shows up-regulated genes.

We all use the easy_input.txt file here, just replace it with the results of your enrichment analysis when you actually apply it.

Include at least: Term, Pvalue, number of genes in group (test, Pop.Hits), number of annotated gene (background, Count) or Gene Ratio (test/background)

```{r}
df <- read.table("easy_input.txt", header = T, sep = "\t", as.is = T)
head(df)
# 算一下gene ratio
# calculate the gene ratio
df$GeneRatio <- df$Pop.Hits/df$Count
```

# 开始画图
# Start drawing

例图横坐标是GeneRatio，点的大小是组内基因数量，颜色代表pvalue。

实际应用时，可以把横坐标、颜色或点的大小所代表的特征值改为你想要的其他列。

The horizontal coordinate of the example plot represents GeneRatio, the size of the dots indicates the number of genes in the group, and the color represents the p-value.

In practical applications, you can modify the feature values represented by the horizontal coordinates, colors, or point sizes to the other columns you want.
