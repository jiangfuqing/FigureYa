---
title: "FigureYa121MethCGIcluster"
author: "Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---


# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr代码块的全局选项 / Set global options for knitr code chunks
```

## 需求描述

用DNA甲基化数据做分型，画出这个图。

## Requirement description

Use DNA methylation data for typing and draw this graph.

![](example.png)

出自<https://link.springer.com/article/10.1007%2Fs00401-018-1854-7>

from<https://link.springer.com/article/10.1007%2Fs00401-018-1854-7>

## 应用场景

DNA甲基化450k数据挑选出CpG位点，然后取高变异的探针，做无监督聚类分子分型。

可用于挖掘TCGA的DNA甲基化数据。

## Application scenarios

Select CpG sites from 450k DNA methylation data, and then use highly variable probes for unsupervised clustering molecular typing.

Can be used to mine DNA methylation data of TCGA.

## 环境设置


## Environment settings


```r

BiocManager::install("ChAMP")
```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载数据处理包
# Load data processing package
library(data.table)
# 加载表观基因组分析包
# Load epigenomic analysis package
library(ChAMP)
# 加载聚类分析包
# Load cluster analysis package
library(ClassDiscovery)
# 加载高级热图绘制包
# Load advanced heatmap plotting package
library(pheatmap)
# 加载基础绘图工具包
# Load basic plotting tools package
library(gplots)
# 加载复杂热图绘制包
# Load complex heatmap plotting package
library(ComplexHeatmap)

# 设置系统环境变量使报错信息显示为英文
# Set system environment variable to display error messages in English
Sys.setenv(LANGUAGE = "en")
# 全局选项设置：禁止字符串自动转换为因子类型
# Global option setting: Disable automatic conversion of strings to factors
options(stringsAsFactors = FALSE)
```

## 输入文件的准备

- HumanMethylation450.gz，甲基化由于数据庞大，这里选择了TCGA中样本量比较小的子宫肉瘤UCS为示例

数据于XENA平台下载，进入<https://xenabrowser.net/datapages/>，点击你感兴趣的癌症。此处以UCS为例，因此点击GDC TCGA Uterine Carcinosarcoma (UCS) (12 datasets)，点击DNA methylation下Illumina Human Methylation 450 (n=57) GDC Hub，<https://xenabrowser.net/datapages/?dataset=TCGA.UCS.sampleMap%2FHumanMethylation450&host=https%3A%2F%2Ftcga.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443>，点击download右侧的链接，下载得到HumanMethylation450.gz，解压到当前文件夹，无后缀名

- easy_input_age.txt，年龄，非必需，仅用于模仿例文的图，还可以是其他数据，可参考FigureYa71ssGSEA获得临床信息。
## Preparation of input files

- HumanMethylation450.gz， Due to the large amount of data involved in methylation, we chose UCS, a uterine sarcoma with a relatively small sample size in TCGA, as an example

Download the data from XENA platform and enter< https://xenabrowser.net/datapages/ >Click on the cancer that interests you. Taking UCS as an example, click on GDC TCGA Uterine Carcinosarcoma (UCS) (12 datasets), then click on Illumina Human Methylation 450 (n=57) GDC Hub under DNA methylation< https://xenabrowser.net/datapages/?dataset=TCGA.UCS.sampleMap%2FHumanMethylation450&host=https%3A%2F%2Ftcga.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443 >Click on the link on the right side of the download to obtain HumanMethylation450.gz. Extract it to the current folder without any extension

- easy_input_age.txt， Age is not necessary and is only used to mimic the example text. It can also be other data, and clinical information can be obtained by referring to FigureYa71ssGSEA.
