---
title: "FigureYa106immunotherapy"
author: "Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---


# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 使用knitr包设置全局代码块选项
# Set global chunk options using knitr package
```

## 需求描述

复现原文中的方法，画出对比的热图。利用TIDE和GenePattern网站的submap算法预测单个样本或者某亚型对免疫治疗的响应可能性。

## Requirement description

Reproduce the method in the original text and draw a comparison heatmap. Using TIDE and GenePattern's submap algorithm to predict the likelihood of a single sample or subtype responding to immunotherapy.

![](example.png)

出自<https://www.sciencedirect.com/science/article/pii/S1476558619301307>

from<https://www.sciencedirect.com/science/article/pii/S1476558619301307>

**注意：**由于包含原文数据，若涉及到注释文件亚型及其他相关数据的使用，请引用：
Lu X, Jiang L, Zhang L, et al. Immune Signature-Based Subtypes of Cervical Squamous Cell Carcinoma Tightly Associated with Human Papillomavirus Type 16 Expression, Molecular Features, and Clinical Outcome[J]. Neoplasia, 2019, 21(6): 591-601.

**Note: * * Due to the inclusion of original data, if it involves the use of annotation file subtypes and other related data, please cite:
Lu X, Jiang L, Zhang L, et al. Immune Signature-Based Subtypes of Cervical Squamous Cell Carcinoma Tightly Associated with Human Papillomavirus Type 16 Expression, Molecular Features, and Clinical Outcome[J]. Neoplasia, 2019, 21(6): 591-601.

## 应用场景

预测单个样本或者某亚型对免疫治疗的响应可能性。

TIDE算法网址 http://tide.dfci.harvard.edu/

submap算法网址 https://cloud.genepattern.org/gp

## Application scenarios

Predict the likelihood of a single sample or subtype responding to immunotherapy.

TIDE algorithm website http://tide.dfci.harvard.edu/

Submap algorithm website https://cloud.genepattern.org/gp

## 环境设置

## Environment settings

```{r}
source("install_dependencies.R")
# 加载pheatmap包，用于绘制热图 | Load the pheatmap package for drawing heatmaps
library(pheatmap)

# 设置系统环境，使R显示英文错误信息 | Set system environment to display error messages in English
Sys.setenv(LANGUAGE = "en")

# 全局选项设置：禁止将字符串自动转换为因子类型 | Global option: Prevent automatic conversion of strings to factors
options(stringsAsFactors = FALSE)
```

## TIDE预测单样本免疫检查点抑制剂响应性

两个输入文件，处理成TIDE所需的格式，在线运行后输出TIDE_output.csv，然后检验免疫治疗响应性和亚型是否相关，p<0.05表示相关。

easy_input_expr.txt，基因表达矩阵。

easy_input_anno.txt，分组信息。示例数据里的C1和C2分别对应"HPV16-IMM"和"HPV16-KRT"。也可以是按某个基因的突变类型分组、或按某个基因表达量高低分组。

两个文件的sample ID必须一致。这两个输入文件跟FigureYa105GDSC一样。

## TIDE predicts single sample immune checkpoint inhibitor responsiveness

Two input files are processed into the format required by TIDE, and after online execution, TIDEoutputting. csv is output. Then, immune therapy responsiveness and subtype are checked for correlation, with p<0.05 indicating correlation.

easy_input_expr.txt， Gene expression matrix.

easy_input_anno.txt， Grouping information. C1 and C2 in the example data correspond to "HPV16-IMM" and "HPV16-KRT", respectively. It can also be grouped according to the mutation type of a certain gene, or according to the high or low expression level of a certain gene.

The sample IDs of the two files must be consistent. These two input files are the same as FigureYa105GDSC.
