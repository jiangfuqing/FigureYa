---
title: "FigureYa222PCAgene"
author: "Zongcheng Li; Ying Ge, Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirement description

这个PCA很特别

This PCA is quite special.

![](example.png)

出自<https://linkinghub.elsevier.com/retrieve/pii/S0092867420300568>

图3. 卵母细胞亚型在逐步发育阶段的动态基因表达模式
(A) 基于主成分1（PC1）和主成分2（PC2）所呈现的基因表达模式，PCA图显示四种卵母细胞亚型。
(B) 沿PC1维度，对卵母细胞发育至关重要的代表性基因的相对基因表达模式。

from<https://linkinghub.elsevier.com/retrieve/pii/S0092867420300568>

Figure 3. Dynamic Gene-Expression Patterns of Oocyte Subtypes at Stepwise Developmental Stages
(A) PCA plot showing four oocyte subtypes based on gene-expression patterns exhibited by PC1 and PC2.
(B) Relative gene-expression patterns of representative genes essential for oocyte development along the PC1 dimension.

# 应用场景
# Application scenario

单细胞RNA-seq，从PCA结果就能看出基因表达模式跟细胞类型的关系。

原文：Principal component analysis (PCA) revealed that the four oocyte subtypes were distributed along the principal component 1 (PC1) dimension (Figure 3A; Table S2).

Consistently, the relative expression levels of **genes known to be essential for follicular development also varied along PC1 axis** (Figures 3B and S3A). Genes promoting follicle development, such as ZP1, BMP15, and GDF9, were progressively **upregulated from oocyte subtype C1 to C4**. Meiotic M phase genes WEE2 and AURKA as well as DNA methyltransferase, DNMT1 and DNMT3A, were also gradually upregulated from subtype C1 to C4 (Figures 3B and S3A).

Single-cell RNA-seq, the relationship between gene expression patterns and cell types can be discerned directly from the PCA results.

Original text: Principal component analysis (PCA) revealed that the four oocyte subtypes were distributed along the principal component 1 (PC1) dimension (Figure 3A; Table S2).

Consistently, the relative expression levels of **genes known to be essential for follicular development also varied along PC1 axis** (Figures 3B and S3A). Genes promoting follicle development, such as ZP1, BMP15, and GDF9, were progressively **upregulated from oocyte subtype C1 to C4**. Meiotic M phase genes WEE2 and AURKA as well as DNA methyltransferase, DNMT1 and DNMT3A, were also gradually upregulated from subtype C1 to C4 (Figures 3B and S3A).

# 环境设置
# Environment setting


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

install.packages("leiden")
install.packages("spatstat")
install.packages("uwot")
install.packages("ggbeeswarm")
```

加载包

load package

```{r}
library(Seurat)
library(magrittr)
library(ggplot2)
Sys.setenv(LANGUAGE = "en") #显示英文报错信息 display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor prohibit the conversion of chr to factor
```

# 输入文件
# Input file

sc.seurat.Rdata，单细胞RNA-seq预处理获得的文件。出自FigureYa206scHeatmap，文件较大，已上传至微云<https://share.weiyun.com/vZiSM9pB>

怎样获得这个文件？拖到文末看“附：单细胞RNA-seq数据预处理”

sc.seurat.Rdata, the file obtained from single-cell RNA-seq preprocessing. It originates from FigureYa206scHeatmap. The file is relatively large and has been uploaded to Weiyun<https://share.weiyun.com/vZiSM9pB>

How to obtain this file? Scroll to the end of the document and see "Appendix: Single-cell RNA-seq Data Preprocessing"

```{r}
(load("sc.seurat.Rdata"))
```

# PCA

## 原文采用的聚类方法
## The clustering method employed in the original text

例文的非监督聚类方法比较特殊，以SCENIC的分析结果作为输入（SCENIC的用法可参考FigureYa194pySCENIC），用modified ‘clustering-and-classification’ algorithm (Lake et al., 2016) 给细胞做聚类。clustering-and-classification也是个很有趣的半监督聚类算法，如果有需要，我们后面再众筹。

The unsupervised clustering method used in the example text is quite unique, taking the analysis results from SCENIC as input (for the usage of SCENIC, you can refer to FigureYa194pySCENIC), and applying modified 'clustering-and-classification' algorithm (Lake et al., 2016) to cluster the cells. The clustering-and-classification is also an interesting semi-supervised clustering algorithm, and if needed, we can consider crowdfunding it later on.

![](clustering.png)

## 我们用Seurat自带的无监督聚类
## We employ Seurat's built-in unsupervised clustering
