---
title: "FigureYa204PCAscore"
author: "Xiaofan Lu"
reviewers: "Ying Ge,Hui Huang"
date: "2025-5-20"
output: html_document
---
# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

想众筹下这个文章的建模方法，不同于常规的lasso, cox回归系数与基因表达量的乘积，这篇文章采用Boruta降维，联合主成分分析第一主成分构建 signature score，特别适合做分子分型分析。

# Requirement Description

I want to crowdfund the modeling method of this article, which is different from the conventional lasso, the product of the cox regression coefficient and the gene expression, this article uses Boruta to reduce the dimension and combine the principal component analysis with the first principal component to construct a signature score, which is especially suitable for molecular typing analysis.

![](method.png)

出自<https://www.cell.com/molecular-therapy-family/nucleic-acids/fulltext/S2162-2531(20)30259-6>
from<https://www.cell.com/molecular-therapy-family/nucleic-acids/fulltext/S2162-2531(20)30259-6>

# 应用场景

根据Figure201ClusterCorrelation得到的亚型以及ICI signature结果，进一步利用Boruta算法对AB签名降维，并利用PCA计算单样本ICI得分。

# Application Scenarios

According to the isoforms obtained by Figure201ClusterCorrelation and the ICI signature results, the Boruta algorithm was used to reduce the dimensionality of AB signatures, and the single-sample ICI score was calculated by PCA.

# 环境设置


# Environment settings


```{r}
source("install_dependencies.R")

install.packages('Boruta')
```
加载包
load package

```{r}
library(Boruta)
library(ggplot2)
library(ggpubr)
library(pheatmap)
Sys.setenv(LANGUAGE = "en") #显示英文报错信息 # Display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor # Prohibit converting chr to factor
```

# 输入文件

easy_input_expr.txt，表达矩阵，这里与原文保持一致，用了TPM，也可以用FPKM。FigureYa201ClusterCorrelation的输入文件是FPKM，同样也可以用TPM。

easy_input_cluster.txt，把Figure201ClusterCorrelation获得的亚型信息（ConsensusCluster文件夹里，ConsensusCluster.k=X.consensusClass.csv对应每种分类数量下sample所在的cluster）写在cluster列。其余为样本信息，跟FigureYa201ClusterCorrelation的`easy_input_sinfo.txt`文件一致。

ouput_ICIsignatureGene.txt，Figure201ClusterCorrelation的ICI signature gene结果。

# Input Files
easy_input_expr.txt, the expression matrix, which is consistent with the original text, uses TPM, and FPKM can also be used. The input file of FigureYa201ClusterCorrelation is FPKM, and TPM can also be used.

easy_input_cluster.txt, write the subtype information obtained by Figure201ClusterCorrelation (in the ConsensusCluster folder, ConsensusCluster.k=X.consensusClass.csv the cluster corresponding to the number of samples under each category) in the cluster column. The rest is sample information, which is the same as the 'easy_input_sinfo.txt' file of FigureYa201ClusterCorrelation.

ouput_ICIsignatureGene.txt, ICI signature gene results of Figure201ClusterCorrelation.
