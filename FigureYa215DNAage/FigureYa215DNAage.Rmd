---
title: "FigureYa215DNAage"
author: "Xiaofan Lu; Ying Ge, Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirement description

求文中甲基化年龄的确定方法。

Determine the method for calculating the methylation age mentioned in the text.

![](method.png)

出自<https://clinicalepigeneticsjournal.biomedcentral.com/articles/10.1186/s13148-020-0822-y>

from<https://clinicalepigeneticsjournal.biomedcentral.com/articles/10.1186/s13148-020-0822-y>

# 应用场景
# Application scenario

根据DNA甲基化beta值计算甲基化年龄，并与真实年龄（chronological age）做差值，计算甲基化年龄加速（Epigenetic age acceleration）。

> 注意：目前甲基化年龄计算只适用于450k和27k数据，850k不适用

接下来，例文把sample分为两组：DNAmAge-ACC（加速）和DNAmAge-DEC（减速），分别分析DNA甲基化年龄跟其他各项特征之间的关系：例如tumor vs normal，HPV16/18 expression，临床信息，immunoactivation，clinical outcomes。

使用本代码或分析思路请引用：

Lu X, Zhou Y, Meng J, et al. Epigenetic age acceleration of cervical squamous cell carcinoma converged to human papillomavirus 16/18 expression, immunoactivation, and favourable prognosis[J]. Clinical Epigenetics, 2020, 12(1): 1-13.

另外，例文中的Fig.1a可参考FigureYa163twoVarCor；
Fig.1e的画法可参考FigureYa162boxViolin；
Fig.2b的画法可参考FigureYa60GSEA_clusterProfiler；
Fig.4f可参考FigureYa99smoothHR。

大鱼海棠的更多作品看这里：<https://k.koudai.com/OFad8N0w>

Calculate the methylation age according to the DNA methylation beta value, and make a difference with chronological age to calculate the epigenetic age acceleration.

> Note: The calculation of methylation age is currently only applicable to 450k and 27k data and is not suitable for 850k data.

Subsequently, the example text divides the sample into two groups: DNAmAge-ACC (accelerated) and DNAmAge-DEC (decelerated), analysing the relationship between DNA methylation age and various other features: such as tumour versus normal, HPV16/18 expression, clinical information, immunoactivation, and clinical outcomes.

When using this code or analytical approach, please cite:

Lu X, Zhou Y, Meng J, et al. Epigenetic age acceleration of cervical squamous cell carcinoma converged to human papillomavirus 16/18 expression, immunoactivation, and favourable prognosis[J]. Clinical Epigenetics, 2020, 12(1): 1-13.

Additionally, for Fig.1a in the example text, you can refer to FigureYa163twoVarCor;
For the drawing method of Fig.1e, you can refer to FigureYa162boxViolin;
For the drawing method of Fig.2b, you can refer to FigureYa60GSEA_clusterProfiler;
for Fig.4f, you can refer to FigureYa99smoothHR.

For more works by Big Fish & Begonia, see: <https://k.koudai.com/OFad8N0w>

# 环境设置
# Environment setting


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

BiocManager::install("ChAMP")
```

加载包

load package

```{r}
library(ChAMP)
library(wateRmelon)
library(data.table)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor prohibit the conversion of chr to factor
```

# 输入文件
# Input file

easy_input_age.txt，临床真实年龄。

HumanMethylation450，CESC的DNA甲基化数据beta value。下载自<https://xenabrowser.net/datapages/?dataset=TCGA.CESC.sampleMap%2FHumanMethylation450&host=https%3A%2F%2Ftcga.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443>，已上传至微云<https://share.weiyun.com/o1g5N29h>

easy_input_age.txt, clinical chronological age.

HumanMethylation450, CESC DNA methylation data beta values. Downloaded from <https://xenabrowser.net/datapages/?dataset=TCGA.CESC.sampleMap%2FHumanMethylation450&host=https%3A%2F%2Ftcga.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443> and uploaded to Weiyun <https://share.weiyun.com/o1g5N29h>
