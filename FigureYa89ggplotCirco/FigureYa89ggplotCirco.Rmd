---
title: "FigureYa89ggplotCircos"
author: "Yuhui Li, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr的全局代码块选项 / Set global chunk options for knitr

```

## 需求描述

用R画出paper里的这种圆圈图。

## Requirement description

Draw the circle diagram in the paper using R.

![](example.png)

出自<https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0990-4>

from<https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0990-4>

Fig. 2 Candidates’ selection and characterization. a. Circos plot shows **58 upregulated RNA-binding proteins (RBPs)** in glioblastoma (GBM) samples from The Cancer Genome Atlas (TCGA) and glioma stem cell (GSC) lines. **Fold-changes and corrected p-values** were extracted from the RNA-Seq analysis (GBM TCGA). Twenty-one RBPs were also associated with survival reduction and were further investigated.

## 应用场景

圆圈图上用热图、柱形图、热图展示多组数据、pvalue和log2FC，可灵活换成其他特征值。

## Application scenarios

Use heatmaps, bar charts, and heatmaps on the circle chart to display multiple sets of data, p-values, and log2FC, which can be flexibly replaced with other feature values.

## 环境设置


## Environment settings


```r

install.packages("readxl", dependencies = TRUE)
install.packages("xlsx", dependencies = TRUE)
```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载数据处理和可视化所需的包
# Load packages required for data processing and visualization
library(readxl)      # 用于读取Excel文件 / For reading Excel files
library(magrittr)    # 提供管道操作符 %>% / Provides pipe operator %>%
library(dplyr)       # 数据处理工具集 / Data manipulation toolkit
library(tibble)      # 增强型数据框 / Enhanced data frames
library(ggplot2)     # 用于数据可视化 / For data visualization

# 设置环境选项
# Set environment options
Sys.setenv(LANGUAGE = "en")  # 设置英文错误信息，便于查找解决方案 / Set English error messages for easier troubleshooting
options(stringsAsFactors = FALSE)  # 禁止自动将字符串转换为因子类型，避免数据类型意外转换 / Prevent automatic conversion of strings to factors
```

## 输入数据的整理

如果你的数据已经整理成easy_input.csv的格式，就可以跳过这步，直接进入“开始画图”。

从文献中看，需要读取`TableS2.TCGA_GBM_DiffExpRBPs`和`TableS3.GSCs_DiffExpRBPs`两个sheet。

另外，图中基因是按照Survival Reduction排列的，根据图反推survival Reduction，保存在survival.csv文件里。

## Organizing input data

If your data has already been organized into easy_input.csv format, you can skip this step and directly enter "Start Drawing".

According to the literature, it is necessary to read two sheets, 'TableS2. TCGA-GBM-DiffExpRBPs' and' TableS3. GSCs_DiffExpRBPs'.

In addition, the genes in the figure are arranged according to the Survival Reduction. Based on the figure, the Survival Reduction is deduced and saved in the Survival.csv file.
