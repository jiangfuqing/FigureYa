---
title: "FigureYa261circGene"
params:
  author: "Shuwen Cheng; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

绘制基因位置的环形图。

Drawing a circular diagram of gene locations.

![](example.png)

出自：<https://molecular-cancer.biomedcentral.com/articles/10.1186/s12943-020-01170-0>

图1 胃癌中m6A调控因子的遗传及表达变异全景
d 基于GSE62717队列的m6A调控因子在23条染色体上的拷贝数变异（CNV）位置分布

Source: <https://molecular-cancer.biomedcentral.com/articles/10.1186/s12943-020-01170-0>

Fig. 1 Landscape of genetic and expression variation of m6A regulators in gastric cancer.
d The location of CNV alteration of m6A regulators on 23 chromosomes using GSE62717 cohort.

# 应用场景
# Application scenarios

把几个感兴趣的基因标注在基因组上，可以像这篇例文画成圆的。

如果基因太多，可以画成直的，可参考FigureYa10chromosome，可以同时展示基因表达量/变化倍数、分类等信息。

如果还想展示基因之间的关系，可参考FigureYa74OmicCircos。

Mark the genes of interest on the genome, which can be drawn in a circular layout like the example provided.

If there are too many genes, a linear layout can be used (refer to FigureYa10chromosome), which can simultaneously display gene expression levels/fold changes, classifications, and other information.

If you also want to illustrate relationships between genes, refer to FigureYa74OmicCircos.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")

BiocManager::install("RCircos")
BiocManager::install("TCGAbiolinks")
```

# 加载包
# Loading packages

```{r}
library(RCircos)
library(magrittr)
library(tidyverse)
library(rtracklayer)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 目标基因位置的获取
# Obtaining Target Gene Locations

如果你已经获得了very_easy_input.txt，就可以跳过这步，直接进入“开始画图”。

easy_input_gene.txt，根据需要定义一个基因集，后面将把基因名标在画成环状的染色体上。

hg38.gtf，基因组上所有基因所在位置，从中提取出目标基因的位置。可以从[gencode](https://www.gencodegenes.org)下载<https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_39/gencode.v39.annotation.gtf.gz>。文件较大，已上传到微云<https://share.weiyun.com/QXyYwYeP>。

If you already have very_easy_input.txt, you can skip this step and proceed directly to "Start Plotting."

easy_input_gene.txt: Define a gene set as needed. These gene names will later be labeled on the circular chromosome plot.

hg38.gtf: Contains the genomic coordinates of all genes. Extract the positions of your target genes from this file. You can download the hg38.gtf file from [gencode](https://www.gencodegenes.org) at: <https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_39/gencode.v39.annotation.gtf.gz>. The file is large. A copy has been uploaded to Weiyun for convenience <https://share.weiyun.com/QXyYwYeP>.
