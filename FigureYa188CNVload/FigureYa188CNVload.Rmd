---
title: "FigureYa188CNVload"
author: "Rongfang Shen"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-9-12"
output: html_document
---
# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

# Requirement

比较不同分子分型之间的focal-level gain & loss burden 和 arm-level gain & loss burden，并且画出下图。
Compare the focal level gain & loss burden and arm level gain & loss burden among different molecular subtypes and draw the following figure.

![](example.png)

出自<https://pubmed.ncbi.nlm.nih.gov/31998649/>
from<https://pubmed.ncbi.nlm.nih.gov/31998649/>

FIGURE 4 | Genetic and copy number alterations across immune subtypes. (A,C) Distribution of TMB (A) and focal and broad copy number alterations (C) among the TME subtypes. The statistical significance of pairwise comparisons is annotated with symbols in which ns and *** represent not significant (P > 0.05) and P ≤ 0.001, respectively A.I., A.S., and M.T. represent the active immune, active stroma and mixed type, respectively.

# 应用场景

# Application Scenarios

刻画分型背后的拷贝数burden变化，不同于TMB，copy number load机制更多的涉及到免疫逃逸方面。类似的文章应用还有[Identification of an Immune-specific Class of Hepatocellular Carcinoma, Based on Molecular Features](https://pubmed.ncbi.nlm.nih.gov/28624577/)
Depict the variation of copy number burden behind typing. Different from TMB, the copy number load mechanism is more related to immune escape. Similar article applications include Identification of an Immune-specific Class of Hepatocellular Carcinoma, Based on Molecular Features

**相似结论请引用文章：**
For similar conclusions, please cite the article:

Shen R, Li P, Li B, Zhang B, Feng L, Cheng S. Identification of Distinct Immune Subtypes in Colorectal Cancer Based on the Stromal Compartment. Front Oncol. 2019;9:1497. doi:10.3389/fonc.2019.01497

# 环境设置

# Environment Setup

```{r}
source("install_dependencies.R")
```

加载包
Loading package

```{r}
library(cowplot)
library(ggplot2)
library(ggpubr)
library(tidyverse)
Sys.setenv(LANGUAGE = "en") #显示英文报错信息  # Display an English error message
options(stringsAsFactors = FALSE) #禁止chr转成factor   # prohibit chr from being converted to factor
```

# 输入文件

# Input File

需要GISTIC的两个输出文件focal_data_by_genes.txt和broad_data_by_genes.txt，以及分组临床输入pdat.txt文件。
Two output files of GISTIC, focal_data_by_genes.txt and broad_data_by_genes.txt, as well as the grouped clinical input pdat.txt file, are required.

具体GISTIC运行输入文件的获取和运行操作参考FigureYa79CNV的附录部分，用的是GISTIC的默认参数。
For the specific acquisition and operation of the GISTIC operation input file, please refer to the appendix of Figure A79CNV, which uses the default parameters of GISTIC.
