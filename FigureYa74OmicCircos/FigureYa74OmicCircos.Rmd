---
title: "FigureYa74omicCircos"
author: "Li Yin, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr的全局代码块选项 / Set global chunk options for knitr
```

## 需求描述

用R复现文章里的图

## Requirement Description

Reproduce a diagram from an article in R

![](example.png)

出自<https://onlinelibrary.wiley.com/doi/abs/10.1111/all.13222>

from<https://onlinelibrary.wiley.com/doi/abs/10.1111/all.13222>

## 应用场景

## Application scenarios

visualizing genomic variations, including mutation patterns, copy number variations (CNVs), expression patterns, and methylation patterns.

支持hg18、hg19、mm9、mm10

例如像例文那样展示多个芯片基因的表达变化和之间的link关系

Support hg18, hg19, mm9, mm10

For example, displaying the expression changes of multiple chip genes and the link relationships between them as in the example text

参考资料：<https://journals.sagepub.com/doi/10.4137/CIN.S13495>

<https://www.bioconductor.org/packages/devel/bioc/html/OmicCircos.html>

reference: <https://journals.sagepub.com/doi/10.4137/CIN.S13495>

<https://www.bioconductor.org/packages/devel/bioc/html/OmicCircos.html>

## 环境设置


## Environment settings


```r

if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("OmicCircos")
```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载必要的R包 / Load necessary R packages
library(S4Vectors)      # 提供S4向量数据结构 / Provides S4 vector data structures
library(tidyverse)     # 数据清洗和分析工具集 / Data cleaning and analysis toolkit
library(OmicCircos)     # 用于绘制环形基因组图 / For drawing circular genomic plots

# 设置R环境显示英文报错信息 / Set R environment to display error messages in English
Sys.setenv(LANGUAGE = "en")

# 防止字符串自动转换为因子 / Prevent automatic conversion of strings to factors
options(stringsAsFactors = FALSE)
```

## 输入数据

如果你的数据已经保存为easy_input.csv格式，就可以跳过这步，进入“开始画图”

- gene.location.csv，基因在染色体上的位置。至少包括基因所在的染色体、起始位置、基因 ID（例如ensembl ID、ENTREZ ID、gene symbol）。此处以人为例，对应hg19版本，来自TCGAbiolinks。

- signal.csv，图中基因的信号值。第一列是gene ID，跟gene.location.csv里的一种基因ID一致，此处是gene symbol；第二列是图中基因名及其连线的颜色，红色连红色，蓝色连蓝色，你也可以写成其他颜色；第三列之后是三组样品的signal，第一组有两个，第二组有三个，第三组有三个。可以是RNA-seq、ChIP-seq、ATAC-seq、CNV、DNA甲基化等信息。用感兴趣的区段信息替换示例中的基因信息。

## Input data

If your data has already been saved in easy_input.csv format, you can skip this step and enter "Start Drawing"

- gene.location.csv， The position of genes on chromosomes. At least including the chromosome where the gene is located, the starting position, and the gene ID (such as ensembl ID, ENTREZ ID, gene symbol). Here is a human example, corresponding to the hg19 version, from TCGAbiolinks.

- signal.csv， The signal values of genes in the figure. The first column is the gene ID, which is consistent with a gene ID in gene.location.csv. Here is the gene symbol; The second column is the color of the gene names and their connecting lines in the figure. Red is connected to red, blue is connected to blue, or you can write them in other colors; After the third column are the signals of three groups of samples, the first group has two, the second group has three, and the third group has three. It can be information such as RNA seq, ChIP seq, ATAC seq, CNV, DNA methylation, etc. Replace the gene information in the example with the segment information of interest.
