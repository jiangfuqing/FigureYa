---
title: "FigureYa209batchEnrich"
author: "Erqiang Hu"
reviewers: "Ying Ge,Hui Huang"
date: "2025-5-20"
output: html_document
---
# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述

[enrichr](https://maayanlab.cloud/Enrichr/)的优点是批量获得各个数据库里的富集结果。如果用clusterprofiler做富集分析，也能一次性把各数据库的结果输出一个报告，就会很方便。

输入一个基因列表（gene symbol和foldchange）和msigdb里的所有gmt文件，用clusterprofiler做富集分析，输出表格和barplot。

# Requirement Description

[enrichr](https://maayanlab.cloud/Enrichr/) has the advantage of obtaining enrichment results in each database in batches. If you use ClusterProfiler for enrichment analysis, you can also output a report of the results of each database at once, which is very convenient.

Enter a list of genes (gene symbol and foldchange) and all GMT files in MSIGDB, use ClusterProfiler for enrichment analysis, and output tables and barplots.

![](example.jpeg)

出自<http://www.docin.com/p-2008991503.html>
from<http://www.docin.com/p-2008991503.html>

# 应用场景

> 富集分析用哪个数据库做注释？

读paper找答案。有的文章用GO，有的用KEGG，有的用hallmark，有的从文献中收集基因集。

哪个适合我？挨个尝试太麻烦，批量全都跑出来。

> 用上调/下调基因分别做富集分析（ORA）？还是用GSEA跑全部基因？

两种方法 X 所有数据库，都跑出来看看。

哪个容易讲故事，最后就选哪个方法、哪个数据库。然后继续做深入研究。后续展示方式可参考<https://k.koudai.com/sm2p0xYn>

# Application Scenarios

> Which database is annotated for enrichment analysis?

Read the paper to find the answer. Some articles use GO, some use KEGG, some use hallmark, and some collect gene sets from the literature.

Which one is right for me? It's too cumbersome to try one by one, and all the batches run out.

> run enrichment analysis (ORA) with up-regulated/down-regulated genes? Or run all the genes with GSEA?

Two methods X all databases, run out and see.

Which is easy to tell a story, in the end, choose which method and which database. Then go ahead and do in-depth research. For details on how to display the follow-up, please refer to <https://k.koudai.com/sm2p0xYn>

# 环境设置


# Environment settings


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

install.packages("msigdbr")
install.packages("shadowtext")
install.packages("ggstance")
```

加载包
load packages

```{r}
library(clusterProfiler)
library(msigdbr)
library(DOSE)
library(enrichplot)
library(ggplot2)
library(plyr)
library(dplyr)
Sys.setenv(LANGUAGE = "en") #显示英文报错信息 # error messages are displayed in English
options(stringsAsFactors = FALSE) #禁止chr转成factor # It is forbidden to convert chr into factor
```

自定义函数
Custom functions
