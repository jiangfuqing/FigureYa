---
title: "FigureYa70mutationEvents"
author: "Yi Xiong, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr代码块的全局选项 / Set global options for knitr code chunks
```

## 需求描述

## Requirements description

co-occurrence/mutual exclusivity分析，画出图d。

co-occurrence/mutual exclusivity analysis, draw figure d.

Co-occurrence/mutual exclusivity -- Only mutations seen in **at least 10 patients** were kept. The **DISCOVER method** was used to determine significant mutual exclusivity and co-occurrence. A plot of the co-occurrences was generated using corrplot with the **odds ratio of the pairwise co-occurrence** used to color and scale the circle sizes.

![](https://media.springernature.com/lw900/springer-static/image/art%3A10.1038%2Fs41586-018-0623-z/MediaObjects/41586_2018_623_Fig1_HTML.png)

出自<https://www.nature.com/articles/s41586-018-0623-z>

from<https://www.nature.com/articles/s41586-018-0623-z>

## 应用场景

用TCGA的基因突变数据分析Co-occurrence/mutual exclusivity。

用corrplot同时展示相关性和显著性。

corrplot这个包对相关性的更多展示方式可参考<http://www.sthda.com/english/wiki/visualize-correlation-matrix-using-correlogram>。

## Application Scenarios

Analyze Co-occurrence/mutual exclusivity with gene mutation data from TCGA.

Demonstrate both correlation and significance with corrplot.

More ways of displaying correlation by the package corrplot can be found at <http://www.sthda.com/english/wiki/visualize-correlation-matrix-using-correlogram>.

## 环境设置

## Environment settings

```{r}
source("install_dependencies.R")
# ====================== 包安装设置 ======================
# ====================== Package Installation Settings ======================

# Use Chinese mirror to accelerate CRAN package downloads (commented out)

# Install Cairo graphics device package (commented out)
# install.packages("Cairo")

# 添加discover包专用仓库并安装 (注释状态)
# Add discover package repository and install (commented out)
# options(repos=c(getOption("repos"), "http://ccb.nki.nl/software/discover/repos/r"))
# install.packages("discover")


# ====================== 加载所需包 ======================
# ====================== Load Required Packages ======================

# 数据重塑包：用于数据结构转换（宽表/长表）
# Data reshaping package: for data structure transformation (wide/long format)
library(reshape2)

# 颜色调色板包：提供科学配色方案
# Color palette package: provides scientific color schemes
library(RColorBrewer)

# 高质量图形输出包：支持多种格式输出
# High-quality graphics package: supports multiple output formats
library(Cairo)

# 差异分析包：用于发现差异特征
# Differential analysis package: for discovering differential features
library(discover)

# 数据读取包：高效读取结构化数据
# Data reading package: efficient reading of structured data
library(readr)

# 相关性可视化包：绘制相关矩阵图
# Correlation visualization package: for plotting correlation matrices
library(corrplot)

# Excel文件操作包：读写Excel文件
# Excel file manipulation package: read/write Excel files
library(openxlsx)


# ====================== 系统环境设置 ======================
# ====================== System Environment Settings ======================

# 设置系统语言环境为英文（保证报错信息是英文）
# Set system language to English (to ensure error messages in English)
Sys.setenv(LANGUAGE = "en")

# 禁止自动将字符串转换为因子（保持字符型数据不变）
# Prevent automatic conversion of strings to factors (keep character data as is)
options(stringsAsFactors = FALSE)
```

## 参数设置

## Parameter setting
