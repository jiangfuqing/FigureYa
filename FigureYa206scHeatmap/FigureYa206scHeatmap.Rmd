---
title: "FigureYa206scHeatmap"
params:
  author: "Zongcheng Li; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

这个图信息量很大，非常高大上，热图和气泡图合用，展示差异富集信号通路信息，最好给众筹一下哈。

This diagram is packed with information and looks very high-end. The combination of a heatmap and bubble chart effectively displays differential enrichment signaling pathways. It would be great to crowdfund this.

![](example.png)

出自：<https://linkinghub.elsevier.com/retrieve/pii/S0092867420300568>

图1. 猕猴卵巢单细胞RNA测序分析揭示具有独特转录特征的卵巢细胞亚群。
(H) 左图：热图展示各细胞类型中前50个特异性表达基因的表达特征，每个基因的值为行标准化Z分数；右图：代表性GO条目。

Source: <https://linkinghub.elsevier.com/retrieve/pii/S0092867420300568>

Figure 1. Distinct Ovarian Cell Subpopulations with Transcriptional Signatures Determined by Single-Cell RNA-Seq Analysis of Monkey Ovaries.
(H) Left: heatmap showing expression signatures of top 50 specifically expressed genes in each cell type; the value for each gene is row-scaled Z score. Right: representative GO terms.

# 应用场景
# Application scenarios

单细胞RNA-seq的表达谱和基因功能富集分析结果的展示。

左侧表达谱热图跟右侧富集分析结果对应，更直观。

Single-cell RNA-seq expression profiles and gene functional enrichment analysis results.

The expression heatmap on the left corresponds to the enrichment analysis results on the right, providing a more intuitive visualization.

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

BiocManager::install("batchelor")
install.packages("Seurat")
install.packages("Hmisc")
```

# 加载包
# Loading packages

```{r}
library(tidyverse)
library(magrittr)
library(Seurat) # v3.1.5
library(pheatmap)
library(RColorBrewer)
library(aplot)
library(patchwork)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

# 输入文件
# Input Files

## 下载单细胞RNA-seq数据
## Download Single-Cell RNA-Seq Data

1) UMI count，从NCBI[GSE130664](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE130664)下载：`GSE130664_merge_UMI_count.txt.gz`文件。

1) UMI counts: Download the `GSE130664_merge_UMI_count.txt.gz` file from NCBI[GSE130664](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE130664)

![](download.png)

2) metadata: 从[例文的](https://doi.org/10.1016/j.cell.2020.01.009)Supplementary Tables获得：`1-s2.0-S0092867420300568-mmc1.xlsx`

2) metadata: Obtain from the supplementary tables of the [example paper](https://doi.org/10.1016/j.cell.2020.01.009): `1-s2.0-S0092867420300568-mmc1.xlsx`

## 读取数据
## Read data
