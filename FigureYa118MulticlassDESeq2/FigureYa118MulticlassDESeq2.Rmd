---
title: "FigureYa118MulticlassDESeq2"
author: "Xiaofan Lu, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr代码块的全局选项 / Set global options for knitr code chunks
```

## 需求描述

用DESeq2实现多组差异分析。能用来替换FigureYa109SubtypeGSEA中的配对差异表达过程（亚型数目>=3），并跟它无缝对接。

## Requirement description

Implement multi group differential analysis using DESeq2. Can be used to replace the paired differential expression process (subtype number>=3) in FigureYa109SubtypeGSEA and seamlessly integrate with it.

## 应用场景

结合FigureYa109subtypeGSEA，分析每一组与其他样品的差异基因，进而找出亚型特异富集的通路；

结合FigureYa116supervisedCluster，分析每一组与其他样品的差异基因，进而找出亚型特异的marker基因。

**注意：**本众筹不涉及批次效应消除，若样本间含有批次效应，请阅读DESeq2相关document并修改该脚本，在设计矩阵中纳入batch effect。

这里针对read count表达矩阵作为输入的情况，如果你的数据是FPKM/RPKM或芯片数据，请参考FigureYa119Multiclasslimma

## Application scenarios

Based on Figure Ya109 subtype GSEA, analyze the differentially expressed genes between each group and other samples, and identify subtype specific enriched pathways;

Using FigureYa116supervisedCluster, analyze the differentially expressed genes between each group and other samples, and identify subtype specific marker genes.

**Note: * * This crowdfunding does not involve batch effect elimination. If there are batch effects between samples, please read the relevant DESeq2 documents and modify the script to include batch effects in the design matrix.

For the case where the read count expression matrix is used as input, if your data is FPKM/RPKM or chip data, please refer to FigureYa119 Multiclasslimma

## 环境设置


## Environment settings


```r

BiocManager::install("DESeq2")
```

加载包

library packages

```{r}
source("install_dependencies.R")
# 加载DESeq2包，用于差异表达基因分析
# Load the DESeq2 package for differential gene expression analysis
library(DESeq2)

# 设置系统环境变量，使R显示英文错误信息（便于搜索解决方案）
# Set environment variable to display error messages in English (for easier troubleshooting)
Sys.setenv(LANGUAGE = "en")

# 禁止R自动将字符串转换为因子类型（避免数据处理时的意外转换）
# Prevent automatic conversion of character strings to factors (avoids unexpected data type changes)
options(stringsAsFactors = FALSE)
```

自定义函数，分别比较每一组跟其他样品之间的差异，如果有更多组，按规律补充进去即可

Customize functions to compare the differences between each group and other samples separately. If there are more groups, simply add them according to the pattern
