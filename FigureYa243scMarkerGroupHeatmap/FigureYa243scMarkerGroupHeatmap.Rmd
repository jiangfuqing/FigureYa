---
title: "FigureYa243scMarkerGroupHeatmap"
author: "Yandong Zheng"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

需求描述 | Requirement Description
只要这张图中间的热图部分。scRNA分不同的cluster鉴定细胞类型；两组之间比较markers的表达高低，调整顺序绘制热图。 Only the heatmap portion in the middle of this figure. scRNA identifies cell types by different clusters; compare marker expression levels between two groups, adjust the order, and plot a heatmap.

![](example.png)

出自<https://www.ahajournals.org/doi/10.1161/CIRCULATIONAHA.119.043833>
From https://www.ahajournals.org/doi/10.1161/CIRCULATIONAHA.119.043833

Figure 1. Neutrophils dominate the heart after myocardial infarction (MI).

D, Gene ontologies of cell-specific differentially expressed genes. The heat maps depict genes ranked by the degree of cell-type specific enrichment. The P value of Gene Ontology enrichment in each gene set is reported. n=4 per sample.

# 应用场景
应用场景 | Application Scenario

例文该图用的是bulk RNA-seq数据，小伙伴觉得特适合用来展示单细胞marker基因在多个cluster当中的表达模式。 The example figure uses bulk RNA-seq data. Teammates think it is particularly suitable for displaying the expression patterns of single-cell marker genes across multiple clusters.

环境设置 | Environment Setup


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

install.packages("Seurat")
devtools::install_github("satijalab/seurat-data")
install.packages("colorRamps")
```

加载包  Load packages

```{r}
library(Seurat)
library(SeuratData)
library(patchwork)
library(RColorBrewer)
library(colorRamps)
library(pheatmap)
library(dplyr)
library(magrittr)
Sys.setenv(LANGUAGE = "en") #显示英文报错信息 | display error messages in English
options(stringsAsFactors = FALSE) #禁止chr转成factor | prevent chr from converting to factor
```

输入文件及前期处理 | Input Files and Preprocessing

这里用Seurat的数据，便于小伙伴套用在自己的单细胞数据上。 Here we use Seurat’s data to make it convenient for teammates to apply to their own single-cell data.
