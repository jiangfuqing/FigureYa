---
title: "FigureYa18oncoplot_update"
author: "Ying Ge; Yijing Chen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Requirement description

用R代码画出paper里的这种瀑布图。

Use R code to draw oncoplot like the one in the paper.

![](example.png)

出自<https://www.cell.com/cell/abstract/S0092-8674(17)30639-6>

from<https://www.cell.com/cell/abstract/S0092-8674(17)30639-6>

# 使用场景
# Usage scenario

展示多个样本中多个基因的突变情况，包括但不限于SNP、indel、CNV。

尤其是几十上百的大样本量的情况下，一目了然，看出哪个基因在哪个人群里突变多，以及多种突变类型的分布。

- 场景一：作为全基因组测序或全外显子组测序文章的第一个图。
- 场景二：展示感兴趣的癌症类型里，某一个通路的基因突变情况。

这里用TCGAbiolinks下载数据，用maftools画图。如果要更灵活的定制，可参考FigureYa42oncoprint，用complexheatmap画图。

maftools功能丰富，浏览一下<https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/maftools.html>，知道用它能画哪些图，需要时就知道过来找啦～

Display the mutations of multiple genes in multiple samples, including but not limited to SNP, indel and CNV.

Especially in the case of dozens or hundreds of large sample volumes, it is clear at a glance which gene has more mutations in which population, and the distribution of multiple types of mutations.

- Scenario 1: As the first figure in a whole genome sequencing or whole exome sequencing article.
- Scenario 2: Show the genetic mutation of a certain pathway in the type of cancer you are interested in.

Here, use TCGAbiolinks to download data and draw with maftools. If you want more flexible customization, you can refer to FigureYa42oncoprint and draw with complexheatmap.

Maftools are rich in functions, browse <https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/maftools.html> to know what kind of graphs you can draw with it, and then come to it when you need it~

# 环境设置
# Environment setting


```{r}
source("install_dependencies.R")
```

```{r, eval=FALSE}

BiocManager::install("TCGAbiolinks")
BiocManager::install("maftools")
```

加载包

load package

```{r}
library(TCGAbiolinks)
library(maftools)
Sys.setenv(LANGUAGE = "en") #显示英文报错信息 display English error messages
options(stringsAsFactors = FALSE) #禁止chr转成factor prohibit the conversion of chr to factor
```

# 输入文件下载
# Input file download

需要下载突变信息和临床信息，作为输入数据。

Mutation information and clinical information need to be downloaded as input data.
