---
title: "FigureYa98STEMheatmapV2"
author: "Yuhui Li, Yandong Zheng, Taojun Ye"
reviewer: "Ying Ge"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# 设置knitr的全局代码块选项 / Set global chunk options for knitr
```

# 需求描述

左侧画出STEM的profile，右侧对应表达量的热图，输出每个profile对应的基因顺序。

# Requirement description

Draw the STEM profile on the left and the heatmap corresponding to the expression level on the right, and output the gene sequence for each profile.

![](example.png)

出自<https://www.pnas.org/content/116/15/7409>

from<https://www.pnas.org/content/116/15/7409>

Fig. 1C. Analysis of coexpression modules in C. cinerea. Heatmap of 7,475 developmentally expressed genes is arranged based on module assignment, with simplified expression profiles and enriched GO terms (no term means no enriched GO) given for each module (see also Dataset S7). We graphically depict **only 27 modules with >50 genes** (refer to SI Appendix, Figs. S4–S9 for the complete list of modules and data for other species). The distribution of key developmental genes is given on the right side of the heatmap.

难点：一共有50个profile，图中左侧只画了基因数量>50的27个profile，然而右侧heatmap却包含所有50个profile里的基因。那么其余的23个profile里的基因要怎样排进右侧的heatmap里呢？

看图中的效果是其余的23个profile里的基因也聚类到相近的profile附近了。

所以，采取的**基因排序策略**是：先按profile聚类，然后在每个profile内部的基因聚类。

Difficulty: There are a total of 50 profiles, and only 27 profiles with a gene count greater than 50 are shown on the left side of the graph. However, the heatmap on the right side contains all the genes in all 50 profiles. So how should the genes from the other 23 profiles be arranged in the heatmap on the right?

The effect in the picture is that the genes in the remaining 23 profiles are also clustered around similar profiles.

So, the adopted gene sorting strategy is to cluster by profile first, and then cluster the genes within each profile.

# 应用场景

同时展示表达趋势和表达量热图。

其中左侧折线图更适合时间序列数据，例如发育时期、处理后的时间点等。

# Application scenarios

Simultaneously display expression trends and expression heatmaps.

The left side line chart is more suitable for time series data, such as developmental stages, processed time points, etc.

# 环境设置


# Environment settings


```{r}
source("install_dependencies.R")
```
