---
title: "FigureYa306slingshot"
params:
  author: "Xiaofan Lu; Yasi Zhang"
  reviewer: "Ying Ge"
  date: "2025-05-20"
output: html_document
---

**Author(s)**: `r params$author`
**Reviewer(s)**: `r params$reviewer`
**Date**: `r params$date`

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 需求描述
# Demand description

我想利用slingshot实现拟时序分析并绘制出特定基因随着时序变化的表达图。FigureYa285scRNA_monocle用monocle画过左边这样的图，但是我更想试一下这个slingshot。

I want to use slingshot to perform pseudotime analysis and plot the expression patterns of specific genes along the inferred trajectory. FigureYa285scRNA_monocle has previously used Monocle to generate the plot on the left, but I'd like to try Slingshot this time.

![](example.png)

出自：<https://www.nature.com/articles/s41591-021-01323-8>

图3：CD8+ TEX 和 CD4+ TH1 轨迹中的差异表达基因

Source: <https://www.nature.com/articles/s41591-021-01323-8>

Fig. 3: Differentially expressed genes in CD8+ TEX and CD4+ TH1 trajectories.

# 应用场景
# Application scenarios

利用slingshot实现拟时序分析，并绘制出特定基因随着时序变化的表达图。

个人审美认为用monocle画出的特定基因随着时序变化的热图更好看，可参考FigureYa285scRNA_monocle <https://k.youshop10.com/ndalTqa=>

Perform pseudotime analysis using Slingshot and generate expression plots of specific genes along the inferred trajectory.

Personally, I find the heatmaps of gene expression dynamics over pseudotime generated by Monocle more visually appealing. For reference, see FigureYa285scRNA_monocle <https://k.youshop10.com/ndalTqa=>

# 环境设置
# Environment Setup


```{r}
source("install_dependencies.R")
```

```{r eval=FALSE}

BiocManager::install("slingshot")
devtools::install_github("statOmics/tradeSeq")
```

# 加载包
# Loading packages

```{r}
library(slingshot)
library(mclust)
library(RColorBrewer)
library(tradeSeq)
library(ComplexHeatmap)
library(circlize)
library(reshape2)
library(ggplot2)
library(ggridges)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en")

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
```

自定义函数

Custom function
