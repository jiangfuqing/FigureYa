---
title: "FigureYa130SVM_step12"
author: "Yufang Wang, Dongqiang Zeng"
reviewer: "Ying Ge, Junyi Shen"
date: "2025-5-20"
output: html_document
---

# Academic Citation
If you use this code in your work or research, we kindly request that you cite our publication:

Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 需求描述
## Requirement Description

筛选差异基因后，用cox regression、SVM-RFE和FW-SVM算法进一步筛选有预后意义的基因，组成基因甲基化位点或表达的signature。
After filtering differential genes, use Cox regression, SVM-RFE, and FW-SVM algorithms to further select prognostic genes to construct a gene methylation site or expression signature.

![](https://wol-prod-cdn.literatumonline.com/cms/attachment/1a5f5bbf-0abb-4122-badc-f9e572b713fb/jcmm14231-fig-0001-m.jpg)

![](https://wol-prod-cdn.literatumonline.com/cms/attachment/1f9f469d-39e7-405e-9310-75e9e2b4e391/jcmm14231-fig-0002-m.jpg)

出自<https://onlinelibrary.wiley.com/doi/full/10.1111/jcmm.14231>
Source: https://onlinelibrary.wiley.com/doi/full/10.1111/jcmm.14231

主要分四步来实现，其中前两步在R里实现，后两步在python里实现，运行完本文档FigureYa130coxSVM_step12.Rmd之后，运行FigureYa130coxSVM_step34.ipynb：
The process consists of four main steps. The first two steps are implemented in R, and the latter two in Python. After running this document FigureYa130coxSVM_step12.Rmd, proceed with FigureYa130coxSVM_step34.ipynb:

- 第一步，正常人与癌症患者差异化比较
Step 1: Differential analysis between normal and cancer samples

- 第二步，寻找相关矩阵，并生成下游数据
Step 2: Identify correlation matrix and generate downstream data

- 第三步，REF-SVM寻找合适的特征范围
Step 3: Use REF-SVM to find the optimal feature range

- 第四步，FW-SVM进一步喜欢特征数目
Step 4: Use FW-SVM to further select feature numbers

## 应用场景
## Application Scenario

## 环境设置
## Environment Setup


```r

# ChAMP depends on many packages. Please be patient during installation.
if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
BiocManager::install("ChAMP")
BiocManager::install(c("minfi","ChAMPdata","Illumina450ProbeVariants.db","sva",
                       "IlluminaHumanMethylation450kmanifest","limma","RPMM","DNAcopy",
                       "preprocessCore","impute","marray","wateRmelon","goseq","plyr","GenomicRanges",
                       "RefFreeEWAS","qvalue","isva","doParallel","bumphunter","quadprog",
                       "shiny","shinythemes","plotly","RColorBrewer","DMRcate","dendextend",
                       "IlluminaHumanMethylationEPICmanifest","FEM","matrixStats","missMethyl","combinat"))
```

加载包
Load required packages

```{r}
source("install_dependencies.R")
library(tidyverse)
library(ChAMP)
library(minfi)
library(RColorBrewer)
library(survival)

Sys.setenv(LANGUAGE = "en") #显示英文报错信息 Display error messages in English
options(stringsAsFactors = FALSE) #禁止chr转成factor Prevent automatic conversion of character to factor
```

## 输入文件下载
## Input File Download

从XENA<https://xenabrowser.net/datapages/>下载两类数据，以GDC TCGA Liver Cancer (LIHC) (14 datasets)为例：
Download two types of data from XENA using the GDC TCGA Liver Cancer (LIHC) (14 datasets) as an example:

- 甲基化数据DNA methylation - Methylation450k，地址：<https://xenabrowser.net/datapages/?dataset=TCGA-LIHC.methylation450.tsv&host=https%3A%2F%2Fgdc.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443>，下载链接：<https://gdc.xenahubs.net/download/TCGA-LIHC.methylation450.tsv.gz>

- DNA methylation data - Methylation450k, location:<https://xenabrowser.net/datapages/?dataset=TCGA-LIHC.methylation450.tsv&host=https%3A%2F%2Fgdc.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443>, Download link:<https://gdc.xenahubs.net/download/TCGA-LIHC.methylation450.tsv.gz>

- 生存数据phenotype, survival data (n=463) GDC Hub，<https://xenabrowser.net/datapages/?dataset=TCGA-LIHC.survival.tsv&host=https%3A%2F%2Fgdc.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443>，下载链接：<https://gdc.xenahubs.net/download/TCGA-LIHC.survival.tsv.gz>

- Survival data: phenotype, survival data (n=463) from GDC Hub, <https://xenabrowser.net/datapages/?dataset=TCGA-LIHC.survival.tsv&host=https%3A%2F%2Fgdc.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443>,  Download link: <https://gdc.xenahubs.net/download/TCGA-LIHC.survival.tsv.gz>
